<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>HTime</title>
  <subtitle>其实，不仅仅是CURD</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://blog.zeyu0633.com/"/>
  <updated>2017-04-06T14:54:52.922Z</updated>
  <id>http://blog.zeyu0633.com/</id>
  
  <author>
    <name>Htime</name>
    <email>code@gmail.com</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Java 线程</title>
    <link href="http://blog.zeyu0633.com/2017/04/06/java-thread/"/>
    <id>http://blog.zeyu0633.com/2017/04/06/java-thread/</id>
    <published>2017-04-06T15:00:00.000Z</published>
    <updated>2017-04-06T14:54:52.922Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>纲要</p>
<ul>
<li>认识线程</li>
<li>认识synchronized</li>
<li>其他关于线程的知识【中断、协作】</li>
</ul>
</blockquote>
<a id="more"></a>
<h2 id="认识线程"><a href="#认识线程" class="headerlink" title="认识线程"></a>认识线程</h2><h3 id="什么是线程"><a href="#什么是线程" class="headerlink" title="什么是线程"></a>什么是线程</h3><blockquote>
<p>线程表示一条单独的执行流，它有自己的程序执行计数器，有自己的栈。</p>
</blockquote>
<h3 id="如何使用线程"><a href="#如何使用线程" class="headerlink" title="如何使用线程"></a>如何使用线程</h3><blockquote>
<p>在Java中创建线程有两种方式，一种是继承Thread，另外一种是实现Runnable接口</p>
</blockquote>
<ul>
<li>继承Thread<br>Java中java.lang.Thread这个类表示线程，一个类可以继承Thread并重写其run方法来实现一个线程<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloThread</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"hello thread!"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p>注意点</p>
<ul>
<li>run方法的方法签名是固定的，public，没有参数，没有返回值，不能抛出受检异常</li>
</ul>
</blockquote>
<p>执行方式</p>
<pre><code>Thread thread = new HelloThread();
thread.start();
</code></pre><p>创建一个线程对象，然后调用start方法，这样，线程就起来啦</p>
<blockquote>
<p>注意点</p>
<ul>
<li>只有调用start方法，才能启动线程，使其成为一条独立的执行语句</li>
<li>如果是调用run方法，那么代码依然在原先的线程中执行，run只是一个普通的方法调用</li>
</ul>
</blockquote>
<p>要想验证，Thread有一个静态方法currentThread，返回当前执行的线程对象，每个Thread都有一个id和name<br>可以通过Thread.currentThread().getName()来打印出线程名称来验证。</p>
<ul>
<li>实现Runnable接口<br>通过继承Thread来实现线程虽然比较简单，但我们知道，Java中只支持单继承，每个类最多只能有一个父类，如果类已经有父类了，就不能再继承Thread，这时，可以通过实现java.lang.Runnable接口来实现线程。<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloRunnable</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"hello thread!"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>执行方式</p>
<pre><code>Thread helloThread = new Thread(new HelloRunnable());
helloThread.start();
</code></pre><blockquote>
<p>注意点</p>
<ul>
<li>仅仅实现Runnable是不够的，要启动线程，还是要创建一个Thread对象，但传递一个Runnable对象</li>
<li>无论是通过继承Thead还是实现Runnable接口来实现线程，启动线程都是调用Thread对象的start方法。</li>
</ul>
</blockquote>
<h3 id="除此之外？"><a href="#除此之外？" class="headerlink" title="除此之外？"></a>除此之外？</h3>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;纲要&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;认识线程&lt;/li&gt;
&lt;li&gt;认识synchronized&lt;/li&gt;
&lt;li&gt;其他关于线程的知识【中断、协作】&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="线程" scheme="http://blog.zeyu0633.com/categories/%E7%BA%BF%E7%A8%8B/"/>
    
    
      <category term="Javar必知必会" scheme="http://blog.zeyu0633.com/tags/Javar%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/"/>
    
  </entry>
  
  <entry>
    <title>APP一条龙</title>
    <link href="http://blog.zeyu0633.com/2017/03/26/APP-Index-A/"/>
    <id>http://blog.zeyu0633.com/2017/03/26/APP-Index-A/</id>
    <published>2017-03-26T15:58:27.000Z</published>
    <updated>2017-03-31T00:58:51.184Z</updated>
    
    <content type="html"><![CDATA[<h3 id="‘产品’诞生记"><a href="#‘产品’诞生记" class="headerlink" title="‘产品’诞生记"></a>‘产品’诞生记</h3><blockquote>
<p>从想法到实现<br>从服务器到客户端<br>从原型图到API<br>从数据库到UI展现<br>从算法到用户体验<br>ALL SELF<br>ta叫做Quick Quiz<br>捂脸..别打人..呦吼吼</p>
</blockquote>
<a id="more"></a>
<h3 id="项目简介"><a href="#项目简介" class="headerlink" title="项目简介"></a>项目简介</h3><blockquote>
<p>在学校里，做过一个APP，叫做‘阅卷助手’，是一个扫描答题卡的工具，当然答题卡也是特制的，主要工作流程就是：设置答案-扫描-分析-生成结果。<br>现在我想对这个APP进行扩展</p>
</blockquote>
<h3 id="上几张图片看一下老APP的样子"><a href="#上几张图片看一下老APP的样子" class="headerlink" title="上几张图片看一下老APP的样子"></a>上几张图片看一下老APP的样子</h3><blockquote>
<p>点击图片查看</p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/4943424-647eaa5bfbce4c71.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" width="200" height="400" alt="1"><br><img src="http://upload-images.jianshu.io/upload_images/4943424-f3f0c58e30775e97.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" width="200" height="400" alt="2"><br><img src="http://upload-images.jianshu.io/upload_images/4943424-49c45896b8de04fe.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" width="200" height="400" alt="3"><br><img src="http://upload-images.jianshu.io/upload_images/4943424-9c2abea8bcbdf342.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" width="200" height="400" alt="4"></p>
<h3 id="扩展目标"><a href="#扩展目标" class="headerlink" title="扩展目标"></a>扩展目标</h3><blockquote>
<p>还没整理好。。。</p>
</blockquote>
<h3 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h3><blockquote>
<p>工欲善其事，必先利其器</p>
<ul>
<li>IntelliJ IDEA，服务器开发</li>
<li>Android Studio，客户端开发（先只开发Android）</li>
<li>墨刀，原型图</li>
<li>Sketch，UI图</li>
<li>Navicat for MySQL，数据库操作</li>
</ul>
</blockquote>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;‘产品’诞生记&quot;&gt;&lt;a href=&quot;#‘产品’诞生记&quot; class=&quot;headerlink&quot; title=&quot;‘产品’诞生记&quot;&gt;&lt;/a&gt;‘产品’诞生记&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;从想法到实现&lt;br&gt;从服务器到客户端&lt;br&gt;从原型图到API&lt;br&gt;从数据库到UI展现&lt;br&gt;从算法到用户体验&lt;br&gt;ALL SELF&lt;br&gt;ta叫做Quick Quiz&lt;br&gt;捂脸..别打人..呦吼吼&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="Quick Quiz" scheme="http://blog.zeyu0633.com/categories/Quick-Quiz/"/>
    
    
      <category term="全栈" scheme="http://blog.zeyu0633.com/tags/%E5%85%A8%E6%A0%88/"/>
    
  </entry>
  
  <entry>
    <title>Http协议 &amp;&amp; Session &amp;&amp; Cookie</title>
    <link href="http://blog.zeyu0633.com/2017/03/21/http-http/"/>
    <id>http://blog.zeyu0633.com/2017/03/21/http-http/</id>
    <published>2017-03-21T15:00:00.000Z</published>
    <updated>2017-03-30T15:08:15.829Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>本文主要内容</p>
<ul>
<li>铺垫一下http协议的内容</li>
<li>对于cookie和session，结合实际代码，观察客户端和服务端的表现</li>
</ul>
</blockquote>
<a id="more"></a>
<h2 id="HTTP协议"><a href="#HTTP协议" class="headerlink" title="HTTP协议"></a>HTTP协议</h2><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><blockquote>
<p>HTTP是一个客户端和服务器端请求和响应的标准TCP。其实建立在TCP之上的。<br>那HTTP协议呢？HTTP协议（HyperText Transfer Protocol）,即超文本传输协议是用于服务器传输到客户端浏览器的传输协议。Web上，服务器和客户端利用HTTP协议进行通信会话。有OOP思想的得出结论：其会话的结构是一个简单的请求/响应序列，即浏览器发出请求和服务器做出响应。</p>
</blockquote>
<h3 id="工作流程"><a href="#工作流程" class="headerlink" title="工作流程"></a>工作流程</h3><p>既然HTTP是基于传输层的TCP协议，而TCP协议是面向连接的端到端的协议。因此，使用HTTP协议传输前，首先建立TCP连接，就是因此在谈的TCP链接过程的“三次握手”。如图</p>
<p><img src="http://upload-images.jianshu.io/upload_images/4943424-243a015df2090079.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="三次握手"></p>
<p>在Web上，HTTP协议使用TCP协议而不是UDP协议的原因在于一个网页必须传送很多数据，而且保证其完整性。TCP协议提供传输控制，按顺序组织数据和错误纠正的一系列功能。<br>一次HTTP操作称为一个事务，其工作过程可分为四步：</p>
<blockquote>
<p>1、客户端与服务器需要建立连接。（比如某个超级链接，HTTP就开始了。）<br>2、建立连接后，发送请求。<br>3、服务器接到请求后，响应其响应信息。<br>4、客户端接收服务器所返回的信息通过浏览器显示在用户的显示屏上，然后客户机与服务器断开连接。</p>
</blockquote>
<p>建立连接，其实建立在TCP连接基础之上。图解核心工作过程（即省去连接过程）如下：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/4943424-387f993533270d62.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="链接"></p>
<h3 id="HTTP报文"><a href="#HTTP报文" class="headerlink" title="HTTP报文"></a>HTTP报文</h3><p>HTTP报文由从客户机到服务器的请求和从服务器到客户机的响应构成。<br>请求报文格式如下：</p>
<blockquote>
<p>请求行 通用信息头 请求头 实体头 （空行） 报文主体</p>
</blockquote>
<p>详解：</p>
<blockquote>
<p>1、请求行 方法字段 + URL + Http协议版本<br>2、通用信息头 Cache-Control头域：指定请求和响应遵循的缓存机制。 keep-alive 是其连接持续有效【在下面百度的例子，会得到验证】<br>3、请求头 Host头域，脑补吧 Referer头域：允许客户端指定请求URL的资源地址。 User-Agent头域：请求用户信息。【可以看出一些客户端浏览器的内核信息】<br>4、报文主体，一般来说，请求主体少不了请求参数。</p>
</blockquote>
<p>应答报文格式如下：</p>
<blockquote>
<p>状态行 通用信息头 响应头 实体头 （空行） 报文主体</p>
</blockquote>
<p>详解：</p>
<blockquote>
<p>1、状态行 HTTP协议版本 + 状态码 + 状态代码的文本描述 【比如，200 代表请求成功】<br>2、通用信息头 keep-alive 是其连接持续有效，Date头域：时间描述<br>3、响应头 Server头：处理请求的原始服务器的软件信息。<br>4、实体头 Content-Type头：便是接收方实体的介质类型。（这也表示了你的报文主体是什么。） （空行）<br>5、报文主体 这里就是HTML响应页面了，在response中可查看。</p>
</blockquote>
<h2 id="cookie"><a href="#cookie" class="headerlink" title="cookie"></a>cookie</h2><h3 id="cookie概述"><a href="#cookie概述" class="headerlink" title="cookie概述"></a>cookie概述</h3><blockquote>
<ul>
<li>Cookie是请求头域和响应头域的字段。简单地说，就是伴随请求和响应的一组键值对的文本，小文本。所以称之为”Cookie“饼干。Cookie的生命来源于服务器。首先是客户端请求服务端，此时请求为第一次，无Cookie参数。这时候，服务端setCookie发送给客户端。记住，Cookie来源自服务端。</li>
<li>Cookie来源自服务端，当然服务于客户。就像你我的会话，文字是在我们之间传递的。所以Cookie用于服务端和客户端的会话。因为Http协议是无状态的，Cookie就是维持会话，说白了就是传递数据的额外媒介。</li>
</ul>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/4943424-bdfd65c9acd0ef3d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="cookie传输过程"></p>
<h3 id="以一个栗子说明上图各个步骤"><a href="#以一个栗子说明上图各个步骤" class="headerlink" title="以一个栗子说明上图各个步骤"></a>以一个栗子说明上图各个步骤</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.htime.controller;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</div><div class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMethod;</div><div class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</div><div class="line"></div><div class="line"><span class="keyword">import</span> javax.servlet.http.Cookie;</div><div class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</div><div class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</div><div class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by HTime on 2017/3/20.</div><div class="line"> */</div><div class="line"><span class="meta">@RestController</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CookieController</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/cookie"</span>, method = RequestMethod.GET)</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getCookie</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> </span>&#123;</div><div class="line"></div><div class="line">        <span class="comment">// 获取客户端Cookie</span></div><div class="line">        Cookie[] cookies = req.getCookies();</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> != cookies) &#123;</div><div class="line">            <span class="keyword">for</span> (Cookie cookie : cookies)</div><div class="line">                System.out.println(cookie.getName() + <span class="string">"-"</span> + cookie.getValue());</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// 创建Cookie</span></div><div class="line">        Cookie cookie = <span class="keyword">new</span> Cookie(<span class="string">"CookieName"</span>, <span class="string">"Htime"</span>);</div><div class="line">        cookie.setMaxAge(<span class="number">10</span>);</div><div class="line">        cookie.setHttpOnly(<span class="keyword">true</span>);</div><div class="line">        resp.addCookie(cookie);</div><div class="line"></div><div class="line">        <span class="keyword">return</span> <span class="string">"Hello cookie!"</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>第一次访问时，在请求头中是不会携带服务端的cookie的</p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/4943424-0c4af19de2ad7b8b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="第一次访问请求头"></p>
<blockquote>
<p>访问成功之后，我们可以在响应头中，看到服务端写入的cookie，所以，cookie是服务端的产物！！！！</p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/4943424-dcd1b4ba9b43c0c6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="第一次访问响应头"></p>
<blockquote>
<p>当服务器接收到cookie之后，会自己保存起来，用于下次访问使用，当对同一url再一次请求时，可以在请求头中看到cookie</p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/4943424-379a977aa79d8840.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="第二次访问请求头"></p>
<blockquote>
<p>在IDEA的控制台中，可以看到将cookie打印出来了，说明cookie成功传到了服务端</p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/4943424-833935155a4ea426.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="控制台"></p>
<blockquote>
<p>cookie是http协议中的一种会话机制，明白了cookie的传输历程，也就明白什么事cookie啦</p>
</blockquote>
<h2 id="session"><a href="#session" class="headerlink" title="session"></a>session</h2><h3 id="概述-1"><a href="#概述-1" class="headerlink" title="概述"></a>概述</h3><blockquote>
<p>Session代表着服务器和客户端一次会话的过程。直到session失效（服务端关闭），或者客户端关闭时结束。<br>Session 是存储在服务端的，并针对每个客户端（客户），通过SessionID来区别不同用户的。Session是以Cookie技术或URL重写实现。默认以Cookie技术实现，服务端会给这次会话创造一个JSESSIONID的Cookie值。</p>
</blockquote>
<h3 id="详解session作用过程"><a href="#详解session作用过程" class="headerlink" title="详解session作用过程"></a>详解session作用过程</h3><p><img src="http://upload-images.jianshu.io/upload_images/4943424-7c3a2a67fc8f5536.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="session作用过程"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.htime.controller;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</div><div class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMethod;</div><div class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</div><div class="line"></div><div class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</div><div class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</div><div class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</div><div class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by HTime on 2017/3/21.</div><div class="line"> */</div><div class="line"><span class="meta">@RestController</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SessionByCookieController</span>  <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/sessionInCookie"</span>, method = RequestMethod.GET)</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">sessionInCookie</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> </span>&#123;</div><div class="line"></div><div class="line">        <span class="comment">//获取session</span></div><div class="line">        HttpSession session = req.getSession();</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (session.isNew()) &#123;</div><div class="line">            <span class="comment">// 设置session属性值</span></div><div class="line">            session.setAttribute(<span class="string">"SessionName"</span>, <span class="string">"Htime"</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// 获取SessionId</span></div><div class="line">        String sessionId = session.getId();</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (session.isNew()) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="string">"第一次请求,sessionId = "</span> + sessionId;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span> <span class="string">"第二次请求,sessionId = "</span> + sessionId + <span class="string">" sessionName = "</span> + session.getAttribute(<span class="string">"SessionName"</span>);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>第一次访问时，服务端会先新建一个session，然后将属性值放进去，此时，这时候，我们不用再把session通过cookie技术处理，容器帮我们处理了。<br>浏览器中会打印出第一次请求，并将sessionId打印出来，并执行了set-cookie</p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/4943424-13287b686e470485.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="session第一次访问"></p>
<blockquote>
<p>第二次访问，服务端会从请求中获取session对象，容器会帮你根据Cookie找到唯一的session对象。<br>浏览器中不仅打印出啦sessionId，也打印出啦属性值，并且没有执行set-cookie</p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/4943424-603699e495a9b95f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="session第二次访问"></p>
<h2 id="HTTP协议知识补充"><a href="#HTTP协议知识补充" class="headerlink" title="HTTP协议知识补充"></a>HTTP协议知识补充</h2><h3 id="请求报文相关：请求行-请求方法"><a href="#请求报文相关：请求行-请求方法" class="headerlink" title="请求报文相关：请求行-请求方法"></a>请求报文相关：请求行-请求方法</h3><blockquote>
<p>GET            请求获取Request-URI所标识的资源<br>POST          在Request-URI所标识的资源后附加新的数据<br>HEAD         请求获取由Request-URI所标识的资源的响应消息报头<br>PUT            请求服务器存储一个资源，并用Request-URI作为其标识<br>DELETE       请求服务器删除Request-URI所标识的资源<br>TRACE        请求服务器回送收到的请求信息，主要用于测试或诊断<br>CONNECT  保留将来使用<br>OPTIONS   请求查询服务器的性能，或者查询与资源相关的选项和需求</p>
</blockquote>
<h3 id="响应报文相关：响应行-状态码"><a href="#响应报文相关：响应行-状态码" class="headerlink" title="响应报文相关：响应行-状态码"></a>响应报文相关：响应行-状态码</h3><blockquote>
<p>1xx：指示信息–表示请求已接收，继续处理<br>2xx：成功–表示请求已被成功接收、理解、接受<br>3xx：重定向–要完成请求必须进行更进一步的操作<br>4xx：客户端错误–请求有语法错误或请求无法实现<br>5xx：服务器端错误–服务器未能实现合法的请求</p>
</blockquote>
<h3 id="常见的状态码"><a href="#常见的状态码" class="headerlink" title="常见的状态码"></a>常见的状态码</h3><blockquote>
<p>200 OK 请求成功（其后是对GET和POST请求的应答文档。）<br>304 Not Modified 未按预期修改文档。客户端有缓冲的文档并发出了一个条件性的请求（一般是提供If-Modified-Since头表示客户只想比指定日期更新的文档）。服务器告诉客户，原来缓冲的文档还可以继续使用。<br>404 Not Found 服务器无法找到被请求的页面。<br>500 Internal Server Error 请求未完成。服务器遇到不可预知的情况。</p>
</blockquote>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;本文主要内容&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;铺垫一下http协议的内容&lt;/li&gt;
&lt;li&gt;对于cookie和session，结合实际代码，观察客户端和服务端的表现&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="HTTP" scheme="http://blog.zeyu0633.com/categories/HTTP/"/>
    
    
      <category term="Javar必知必会" scheme="http://blog.zeyu0633.com/tags/Javar%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/"/>
    
  </entry>
  
  <entry>
    <title>Mysql 存储过程</title>
    <link href="http://blog.zeyu0633.com/2017/03/16/mysql-process/"/>
    <id>http://blog.zeyu0633.com/2017/03/16/mysql-process/</id>
    <published>2017-03-16T12:00:00.000Z</published>
    <updated>2017-03-30T05:23:52.239Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>列几个最近写了用到的栗子</p>
</blockquote>
<a id="more"></a>
<blockquote>
<ul>
<li>对数据表进行分表，写的一个分表的过程</li>
</ul>
</blockquote>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">CREATE procedure create_table()</div><div class="line">BEGIN</div><div class="line">DECLARE `@i` int(20);</div><div class="line">DECLARE `@sqlstr` varchar(4096);</div><div class="line">SET `@i`=0;</div><div class="line">WHILE `@i` &lt; 512 DO</div><div class="line"></div><div class="line">SET @sqlstr = CONCAT(</div><div class="line">"CREATE TABLE post_push_",</div><div class="line">`@i`,</div><div class="line"></div><div class="line">"(</div><div class="line">  `id` bigint(20) NOT NULL,</div><div class="line">  `uid` bigint(20) NOT NULL,</div><div class="line">  `uid_follower` bigint(20) NOT NULL,</div><div class="line">  `pid` bigint(20) NOT NULL,</div><div class="line">  `postTime` datetime DEFAULT NULL,</div><div class="line">  `addTime` datetime DEFAULT NULL,</div><div class="line">  PRIMARY KEY (`id`, `uid`)</div><div class="line">) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4"</div><div class="line"></div><div class="line">);</div><div class="line">prepare stmt from @sqlstr;</div><div class="line">execute stmt;</div><div class="line"></div><div class="line">SET `@i` = `@i` + 1;</div><div class="line">END WHILE;</div><div class="line">END;</div><div class="line">call create_table();</div><div class="line">drop procedure create_table;</div></pre></td></tr></table></figure>
<blockquote>
<ul>
<li>分表之后，后台还没写好，但是接口已经给出去啦，为了方便调试和验证，需要造一些数据，然后写了一个过程</li>
</ul>
</blockquote>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line">DROP PROCEDURE if exists create_data_for_msg;</div><div class="line"></div><div class="line">DELIMITER ;; </div><div class="line">CREATE procedure create_data_for_msg()</div><div class="line">BEGIN</div><div class="line">DECLARE `@i` int(20);</div><div class="line">DECLARE `@tout` int(20);</div><div class="line">DECLARE `@tin` int(20);</div><div class="line">DECLARE `@u` int(20);</div><div class="line">DECLARE `@gid` int(20);</div><div class="line">DECLARE `@sqlstr` varchar(4096);</div><div class="line">SET `@u`=9202532;</div><div class="line">SET `@i`=`@u`%512;</div><div class="line">SET `@tout`=0;</div><div class="line">SET `@tin`=0;</div><div class="line"></div><div class="line">WHILE `@tout` &lt; 200 DO</div><div class="line"></div><div class="line">SET `@gid` = 1047 + `@tout`;</div><div class="line"></div><div class="line">SET @sqlstr = CONCAT(</div><div class="line">"INSERT INTO user_msg_group_",`@i`,"( `uid`, `gid`, `des`, `groupType`, `status`, `createDate`, `updateTime`) VALUES",</div><div class="line">   "(",`@u`,", ",`@gid`,", 123, 5, 0, sysDate(), unix_timestamp(SYSDATE()) * 1000) ON DUPLICATE KEY UPDATE `updateTime` = unix_timestamp(SYSDATE()) * 1000;");</div><div class="line"></div><div class="line">PREPARE stmt FROM @sqlstr;</div><div class="line">execute stmt;</div><div class="line"></div><div class="line">SET @sqlstr = CONCAT(</div><div class="line">"INSERT INTO user_msg_",`@i`,"( `uid`, `gid`, `groupType`, `msgType`, `data`, `style`, `status`, `createDate`, `updateTime`) VALUES",</div><div class="line">   "(",`@u`,", ",`@gid`,", 5, 5001, '261', 101, 0, sysDate(), unix_timestamp(SYSDATE()) * 1000),</div><div class="line">    (",`@u`,", ",`@gid`,", 5, 5001, '2', 101, 0, sysDate(), unix_timestamp(SYSDATE()) * 1000),</div><div class="line">	(",`@u`,", ",`@gid`,", 5, 5001, '3', 101, 0, sysDate(), unix_timestamp(SYSDATE()) * 1000),</div><div class="line">	(",`@u`,", ",`@gid`,", 5, 5001, '48', 102, 0, sysDate(), unix_timestamp(SYSDATE()) * 1000),</div><div class="line">	(",`@u`,", ",`@gid`,", 5, 5001, '86', 102, 0, sysDate(), unix_timestamp(SYSDATE()) * 1000),</div><div class="line">	(",`@u`,", ",`@gid`,", 5, 5001, '51', 103, 0, sysDate(), unix_timestamp(SYSDATE()) * 1000),</div><div class="line">	(",`@u`,", ",`@gid`,", 5, 5001, '263', 103, 0, sysDate(), unix_timestamp(SYSDATE()) * 1000),</div><div class="line">	(",`@u`,", ",`@gid`,", 5, 5001, '94', 104, 0, sysDate(), unix_timestamp(SYSDATE()) * 1000),</div><div class="line">	(",`@u`,", ",`@gid`,", 5, 5001, '95', 105, 0, sysDate(), unix_timestamp(SYSDATE()) * 1000),</div><div class="line">	(",`@u`,", ",`@gid`,", 5, 5001, '39', 201, 0, sysDate(), unix_timestamp(SYSDATE()) * 1000),</div><div class="line">	(",`@u`,", ",`@gid`,", 5, 5001, '42', 201, 0, sysDate(), unix_timestamp(SYSDATE()) * 1000),</div><div class="line">	(",`@u`,", ",`@gid`,", 5, 5001, '43', 201, 0, sysDate(), unix_timestamp(SYSDATE()) * 1000),</div><div class="line">	(",`@u`,", ",`@gid`,", 5, 5001, '52', 201, 0, sysDate(), unix_timestamp(SYSDATE()) * 1000),</div><div class="line">	(",`@u`,", ",`@gid`,", 5, 5001, '53', 202, 0, sysDate(), unix_timestamp(SYSDATE()) * 1000),</div><div class="line">	(",`@u`,", ",`@gid`,", 5, 5001, '222', 202, 0, sysDate(), unix_timestamp(SYSDATE()) * 1000),</div><div class="line">	(",`@u`,", ",`@gid`,", 5, 5001, '1184', 202, 0, sysDate(), unix_timestamp(SYSDATE()) * 1000),</div><div class="line">	(",`@u`,", ",`@gid`,", 5, 5001, '54', 203, 0, sysDate(), unix_timestamp(SYSDATE()) * 1000);"</div><div class="line"></div><div class="line">);</div><div class="line"></div><div class="line">WHILE `@tin` &lt; 20 DO</div><div class="line">PREPARE stmt FROM @sqlstr;</div><div class="line">execute stmt;</div><div class="line">SET `@tin` = `@tin` + 1;</div><div class="line">END WHILE;</div><div class="line"></div><div class="line">SET `@tin`=0;</div><div class="line"></div><div class="line">SET `@tout` = `@tout` + 1;</div><div class="line">END WHILE;</div><div class="line">END;</div><div class="line">call create_data_for_msg();</div><div class="line">drop procedure create_data_for_msg;</div></pre></td></tr></table></figure>
<blockquote>
<ul>
<li>发一个有关送奖品拉新的活动，需要将不同的奖品散列到不同时间段里，写了一个过程</li>
</ul>
</blockquote>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">DROP PROCEDURE if exists award_pool_insert_prc;</div><div class="line"></div><div class="line">DELIMITER ;;  </div><div class="line">CREATE PROCEDURE award_pool_insert_prc ()  </div><div class="line">BEGIN  </div><div class="line">  </div><div class="line">DECLARE i INT DEFAULT 1;</div><div class="line">  </div><div class="line">##iPhone 7 35  1个</div><div class="line">WHILE i&lt;=1 </div><div class="line">DO  </div><div class="line">	insert into btime_event.award_record_pool ( uuid, awID, status, activeTime, createTime) values( REPLACE(uuid(), '-',''), 35, 0, DATE_ADD('2016-12-26 06:00:00',  INTERVAL  FLOOR(1 + (RAND() * 64800))   SECOND ) ,  now());</div><div class="line">	commit;</div><div class="line">	SET i=i+1;  </div><div class="line">END WHILE ; </div><div class="line">SELECT 'awID: 35  inited' ;</div><div class="line"></div><div class="line">##儿童手表 36 5个 </div><div class="line">SET i=1; </div><div class="line">WHILE i&lt;=1 </div><div class="line">DO  </div><div class="line">	insert into btime_event.award_record_pool ( uuid, awID, status, activeTime, createTime) values( REPLACE(uuid(), '-',''), 36, 0, DATE_ADD('2016-12-19 06:00:00',  INTERVAL  FLOOR(1 + (RAND() * 64800 ))   SECOND ) ,  now());</div><div class="line">	insert into btime_event.award_record_pool ( uuid, awID, status, activeTime, createTime) values( REPLACE(uuid(), '-',''), 36, 0, DATE_ADD('2016-12-20 06:00:00',  INTERVAL  FLOOR(1 + (RAND() * 64800 ))   SECOND ) ,  now());</div><div class="line">	insert into btime_event.award_record_pool ( uuid, awID, status, activeTime, createTime) values( REPLACE(uuid(), '-',''), 36, 0, DATE_ADD('2016-12-21 06:00:00',  INTERVAL  FLOOR(1 + (RAND() * 64800 ))   SECOND ) ,  now());</div><div class="line">	insert into btime_event.award_record_pool ( uuid, awID, status, activeTime, createTime) values( REPLACE(uuid(), '-',''), 36, 0, DATE_ADD('2016-12-22 06:00:00',  INTERVAL  FLOOR(1 + (RAND() * 64800 ))   SECOND ) ,  now());</div><div class="line">	insert into btime_event.award_record_pool ( uuid, awID, status, activeTime, createTime) values( REPLACE(uuid(), '-',''), 36, 0, DATE_ADD('2016-12-23 06:00:00',  INTERVAL  FLOOR(1 + (RAND() * 64800 ))   SECOND ) ,  now());</div><div class="line">	SET i=i+1;  </div><div class="line">END WHILE ; </div><div class="line">commit;</div><div class="line">SELECT 'awID: 36  inited' ;</div><div class="line"></div><div class="line">END;;</div><div class="line">  </div><div class="line">CALL award_pool_insert_prc();</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;列几个最近写了用到的栗子&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="Mysql" scheme="http://blog.zeyu0633.com/categories/Mysql/"/>
    
    
      <category term="Javar必知必会" scheme="http://blog.zeyu0633.com/tags/Javar%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/"/>
    
  </entry>
  
  <entry>
    <title>Mysql 基础</title>
    <link href="http://blog.zeyu0633.com/2017/03/15/mysql-basic/"/>
    <id>http://blog.zeyu0633.com/2017/03/15/mysql-basic/</id>
    <published>2017-03-15T15:00:00.000Z</published>
    <updated>2017-03-30T15:07:16.538Z</updated>
    
    <content type="html"><![CDATA[<h3 id="概要"><a href="#概要" class="headerlink" title="概要"></a>概要</h3><blockquote>
<p>最近看了《MySQL 存储过程编程》这本书，再结合在慕课网上的《与MySQL的零距离接触》教程，记录一下</p>
</blockquote>
<a id="more"></a>
<h3 id="还没有写呢"><a href="#还没有写呢" class="headerlink" title="还没有写呢"></a>还没有写呢</h3>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;概要&quot;&gt;&lt;a href=&quot;#概要&quot; class=&quot;headerlink&quot; title=&quot;概要&quot;&gt;&lt;/a&gt;概要&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;最近看了《MySQL 存储过程编程》这本书，再结合在慕课网上的《与MySQL的零距离接触》教程，记录一下&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="Mysql" scheme="http://blog.zeyu0633.com/categories/Mysql/"/>
    
    
      <category term="Javar必知必会" scheme="http://blog.zeyu0633.com/tags/Javar%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/"/>
    
  </entry>
  
  <entry>
    <title>Mysql 优化</title>
    <link href="http://blog.zeyu0633.com/2017/03/15/mysql-better/"/>
    <id>http://blog.zeyu0633.com/2017/03/15/mysql-better/</id>
    <published>2017-03-15T12:00:00.000Z</published>
    <updated>2017-03-30T15:07:16.512Z</updated>
    
    <content type="html"><![CDATA[<h3 id="概要"><a href="#概要" class="headerlink" title="概要"></a>概要</h3><blockquote>
<p>最近看了《MySQL 存储过程编程》这本书，再结合在慕课网上的《与MySQL的零距离接触》教程，记录一下</p>
</blockquote>
<a id="more"></a>
<h3 id="还没有写呢"><a href="#还没有写呢" class="headerlink" title="还没有写呢"></a>还没有写呢</h3>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;概要&quot;&gt;&lt;a href=&quot;#概要&quot; class=&quot;headerlink&quot; title=&quot;概要&quot;&gt;&lt;/a&gt;概要&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;最近看了《MySQL 存储过程编程》这本书，再结合在慕课网上的《与MySQL的零距离接触》教程，记录一下&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="Mysql" scheme="http://blog.zeyu0633.com/categories/Mysql/"/>
    
    
      <category term="Javar必知必会" scheme="http://blog.zeyu0633.com/tags/Javar%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/"/>
    
  </entry>
  
  <entry>
    <title>正则表达式 Java</title>
    <link href="http://blog.zeyu0633.com/2017/03/12/ze-java/"/>
    <id>http://blog.zeyu0633.com/2017/03/12/ze-java/</id>
    <published>2017-03-12T08:00:00.000Z</published>
    <updated>2017-03-30T15:09:36.144Z</updated>
    
    <content type="html"><![CDATA[<h3 id="正则表达式介绍"><a href="#正则表达式介绍" class="headerlink" title="正则表达式介绍"></a>正则表达式介绍</h3><blockquote>
<p>在编写处理字符串的程序或网页时，经常会有查找符合某些复杂规则的字符串的需要。正则表达式就是用于描述这些规则的工具。换句话说，正则表达式就是记录文本规则的代码。</p>
</blockquote>
<a id="more"></a>
<h3 id="java-util-regex"><a href="#java-util-regex" class="headerlink" title="java.util.regex"></a>java.util.regex</h3><blockquote>
<ul>
<li>Pattern 类：pattern 对象是一个正则表达式的编译表示。Pattern 类没有公共构造方法。要创建一个 Pattern 对象，你必须首先调用其公共静态编译方法，它返回一个 Pattern 对象。该方法接受一个正则表达式作为它的第一个参数。</li>
<li>Matcher 类：Matcher 对象是对输入字符串进行解释和匹配操作的引擎。与Pattern 类一样，Matcher 也没有公共构造方法。你需要调用 Pattern 对象的 matcher 方法来获得一个 Matcher 对象。</li>
<li>PatternSyntaxException：PatternSyntaxException 是一个非强制异常类，它表示一个正则表达式模式中的语法错误。</li>
</ul>
</blockquote>
<h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><blockquote>
<ul>
<li><p>正则表达式实例</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.regex.*;</div><div class="line"> </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">RegexExample1</span></span>&#123;</div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span></span>&#123;</div><div class="line">      String content = <span class="string">"I am noob "</span> +</div><div class="line">        <span class="string">"from runoob.com."</span>;</div><div class="line"> </div><div class="line">      String pattern = <span class="string">".*runoob.*"</span>;</div><div class="line"> </div><div class="line">      <span class="keyword">boolean</span> isMatch = Pattern.matches(pattern, content);</div><div class="line">      System.out.println(<span class="string">"字符串中是否包含了 'runoob' 子字符串? "</span> + isMatch);</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>捕获组</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.regex.Matcher;</div><div class="line"><span class="keyword">import</span> java.util.regex.Pattern;</div><div class="line"> </div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RegexMatches</span></span></div><div class="line">&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">( String args[] )</span></span>&#123;</div><div class="line"> </div><div class="line">      <span class="comment">// 按指定模式在字符串查找</span></div><div class="line">      String line = <span class="string">"This order was placed for QT3000! OK?"</span>;</div><div class="line">      String pattern = <span class="string">"(\\D*)(\\d+)(.*)"</span>;</div><div class="line"> </div><div class="line">      <span class="comment">// 创建 Pattern 对象</span></div><div class="line">      Pattern r = Pattern.compile(pattern);</div><div class="line"> </div><div class="line">      <span class="comment">// 现在创建 matcher 对象</span></div><div class="line">      Matcher m = r.matcher(line);</div><div class="line">      <span class="keyword">if</span> (m.find( )) &#123;</div><div class="line">         System.out.println(<span class="string">"Found value: "</span> + m.group(<span class="number">0</span>) );</div><div class="line">         System.out.println(<span class="string">"Found value: "</span> + m.group(<span class="number">1</span>) );</div><div class="line">         System.out.println(<span class="string">"Found value: "</span> + m.group(<span class="number">2</span>) );</div><div class="line">         System.out.println(<span class="string">"Found value: "</span> + m.group(<span class="number">3</span>) ); </div><div class="line">      &#125; <span class="keyword">else</span> &#123;</div><div class="line">         System.out.println(<span class="string">"NO MATCH"</span>);</div><div class="line">      &#125;</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>start 和 end 方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.regex.Matcher;</div><div class="line"><span class="keyword">import</span> java.util.regex.Pattern;</div><div class="line"> </div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RegexMatches</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String REGEX = <span class="string">"\\bcat\\b"</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String INPUT =</div><div class="line">                                    <span class="string">"cat cat cat cattie cat"</span>;</div><div class="line"> </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">( String args[] )</span></span>&#123;</div><div class="line">       Pattern p = Pattern.compile(REGEX);</div><div class="line">       Matcher m = p.matcher(INPUT); <span class="comment">// 获取 matcher 对象</span></div><div class="line">       <span class="keyword">int</span> count = <span class="number">0</span>;</div><div class="line"> </div><div class="line">       <span class="keyword">while</span>(m.find()) &#123;</div><div class="line">         count++;</div><div class="line">         System.out.println(<span class="string">"Match number "</span>+count);</div><div class="line">         System.out.println(<span class="string">"start(): "</span>+m.start());</div><div class="line">         System.out.println(<span class="string">"end(): "</span>+m.end());</div><div class="line">      &#125;</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>matches 和 lookingAt 方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.regex.Matcher;</div><div class="line"><span class="keyword">import</span> java.util.regex.Pattern;</div><div class="line"> </div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RegexMatches</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String REGEX = <span class="string">"foo"</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String INPUT = <span class="string">"fooooooooooooooooo"</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Pattern pattern;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Matcher matcher;</div><div class="line"> </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">( String args[] )</span></span>&#123;</div><div class="line">       pattern = Pattern.compile(REGEX);</div><div class="line">       matcher = pattern.matcher(INPUT);</div><div class="line"> </div><div class="line">       System.out.println(<span class="string">"Current REGEX is: "</span>+REGEX);</div><div class="line">       System.out.println(<span class="string">"Current INPUT is: "</span>+INPUT);</div><div class="line"> </div><div class="line">       System.out.println(<span class="string">"lookingAt(): "</span>+matcher.lookingAt());</div><div class="line">       System.out.println(<span class="string">"matches(): "</span>+matcher.matches());</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>replaceFirst 和 replaceAll 方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.regex.Matcher;</div><div class="line"><span class="keyword">import</span> java.util.regex.Pattern;</div><div class="line"> </div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RegexMatches</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String REGEX = <span class="string">"dog"</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String INPUT = <span class="string">"The dog says meow. "</span> +</div><div class="line">                                    <span class="string">"All dogs say meow."</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String REPLACE = <span class="string">"cat"</span>;</div><div class="line"> </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">       Pattern p = Pattern.compile(REGEX);</div><div class="line">       <span class="comment">// get a matcher object</span></div><div class="line">       Matcher m = p.matcher(INPUT); </div><div class="line">       INPUT = m.replaceAll(REPLACE);</div><div class="line">       System.out.println(INPUT);</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>appendReplacement 和 appendTail 方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.regex.Matcher;</div><div class="line"><span class="keyword">import</span> java.util.regex.Pattern;</div><div class="line"> </div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RegexMatches</span></span></div><div class="line">&#123;</div><div class="line">   <span class="keyword">private</span> <span class="keyword">static</span> String REGEX = <span class="string">"a*b"</span>;</div><div class="line">   <span class="keyword">private</span> <span class="keyword">static</span> String INPUT = <span class="string">"aabfooaabfooabfoob"</span>;</div><div class="line">   <span class="keyword">private</span> <span class="keyword">static</span> String REPLACE = <span class="string">"-"</span>;</div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">      Pattern p = Pattern.compile(REGEX);</div><div class="line">      <span class="comment">// 获取 matcher 对象</span></div><div class="line">      Matcher m = p.matcher(INPUT);</div><div class="line">      StringBuffer sb = <span class="keyword">new</span> StringBuffer();</div><div class="line">      <span class="keyword">while</span>(m.find())&#123;</div><div class="line">         m.appendReplacement(sb,REPLACE);</div><div class="line">      &#125;</div><div class="line">      m.appendTail(sb);</div><div class="line">      System.out.println(sb.toString());</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
</blockquote>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;正则表达式介绍&quot;&gt;&lt;a href=&quot;#正则表达式介绍&quot; class=&quot;headerlink&quot; title=&quot;正则表达式介绍&quot;&gt;&lt;/a&gt;正则表达式介绍&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;在编写处理字符串的程序或网页时，经常会有查找符合某些复杂规则的字符串的需要。正则表达式就是用于描述这些规则的工具。换句话说，正则表达式就是记录文本规则的代码。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="正则表达式" scheme="http://blog.zeyu0633.com/categories/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
    
    
      <category term="Javar必知必会" scheme="http://blog.zeyu0633.com/tags/Javar%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/"/>
    
  </entry>
  
  <entry>
    <title>正则表达式 实践</title>
    <link href="http://blog.zeyu0633.com/2017/03/12/ze-practices/"/>
    <id>http://blog.zeyu0633.com/2017/03/12/ze-practices/</id>
    <published>2017-03-12T07:00:00.000Z</published>
    <updated>2017-03-30T15:09:36.114Z</updated>
    
    <content type="html"><![CDATA[<h3 id="正则表达式介绍"><a href="#正则表达式介绍" class="headerlink" title="正则表达式介绍"></a>正则表达式介绍</h3><blockquote>
<p>在编写处理字符串的程序或网页时，经常会有查找符合某些复杂规则的字符串的需要。正则表达式就是用于描述这些规则的工具。换句话说，正则表达式就是记录文本规则的代码。</p>
</blockquote>
<a id="more"></a>
<h2 id="常用知识点详解"><a href="#常用知识点详解" class="headerlink" title="常用知识点详解"></a>常用知识点详解</h2><h3 id="匹配汉字或中文"><a href="#匹配汉字或中文" class="headerlink" title="匹配汉字或中文"></a>匹配汉字或中文</h3><blockquote>
<p>正则匹配中文汉字根据页面编码不同而略有区别：<br>GBK/GB2312编码：[x80-xff&gt;]+ 或 [xa1-xff]+<br>UTF-8编码：[x{4e00}-x{9fa5}]+/u</p>
</blockquote>
<h3 id="匹配身份证号码"><a href="#匹配身份证号码" class="headerlink" title="匹配身份证号码"></a>匹配身份证号码</h3><blockquote>
<p>身份证为15位或者18位，15位的全为数字，18位的前17位为数字，最后一位为数字或者大写字母”X“。<br>与之匹配的正则表达式：(^\d{15}$)|(^\d{17}([0-9]|X)$)</p>
</blockquote>
<h3 id="匹配电子邮箱"><a href="#匹配电子邮箱" class="headerlink" title="匹配电子邮箱"></a>匹配电子邮箱</h3><blockquote>
<p>正则匹配表达式：/^<a href="[a-z0-9]*[-_]?[a-z0-9]+">a-z</a><em>@([a-z0-9]</em>[-<em>]?[a-z0-9]+)+[.][a-z]{2,3}([.][a-z]{2})?$/i<br>说明：<br>①/内容/i 构成一个不区分大小写的正则表达式；^ 匹配开始；$ 匹配结束。<br>②[a-z] E-Mail前缀必需是一个英文字母开头<br>③([a-z0-9]*[-</em>]?[a-z0-9]+)<em> 和_a_2、aaa11、_1_a<em>2匹配，和a1</em>、aaff<em>33a</em>、a__aa不匹配，如果是空字符，也是匹配的，</em>表示0个或者多个。<br>④<em>表示0个或多个前面的字符.<br>⑤[a-z0-9]</em> 匹配0个或多个英文字母或者数字；[-<em>]? 匹配0个或1“-”，因为“-”不能连续出现。<br>⑥[a-z0-9]+ 匹配1个或多个英文字母或者数字，因为“-”不能做为结尾<br>⑦@ 必需有个有@<br>⑧([a-z0-9]*[-</em>]?[a-z0-9]+)+ 见上面([a-z0-9]<em>[-_]?[a-z0-9]+)</em>解释，但是不能为空，+表示一个或者为多个。<br>⑨[.] 将特殊字符(.)当成普通字符；[a-z]{2,3} 匹配2个至3个英文字母，一般为com或者net等。<br>⑩([.][a-z]{2})? 匹配0个或者1个[.][a-z]{2}(比如.cn等) 我不知道一般.com.cn最后部份是不是都是两位的,如果不是请修改{2}为{起始字数,结束字数} </p>
</blockquote>
<h3 id="匹配用户密码"><a href="#匹配用户密码" class="headerlink" title="匹配用户密码"></a>匹配用户密码</h3><blockquote>
<p>密码形式可以根据开发需求自己设定，下面是几个匹配密码的例子：</p>
</blockquote>
<p>正则表达式： ^[a-zA-Z]\w{5,17}$<br>匹配：       以字母开头，长度在6~18之间，只能包含字符、数字和下划线<br>不匹配：     </p>
<p>正则表达式： [^A-Za-z0-9]<br>匹配：       !@#$ | %^&amp;* | ‘&gt;&lt;?.,&quot;<br>不匹配：     ABC123abc | abc123ABC | abc0132ABC</p>
<p>正则表达式： (?-i)(?=^.{8,}$)((?!.<em>\s)(?=.</em>[A-Z])(?=.<em>[a-z]))(?=(1)(?=.</em>\d)|.<em>[^A-Za-z0-9])^.</em>$<br>匹配：       a3dAbed. | P@ssword1 | aB_1bbbb | myPassw0rd!<br>不匹配：     password | password12 | password__12 | p@ssw0rd</p>
<h3 id="匹配日期时间"><a href="#匹配日期时间" class="headerlink" title="匹配日期时间"></a>匹配日期时间</h3><p>正则表达式： (\d{2}|\d{4})(?:-)?([0]{1}\d{1}|[1]{1}[0-2]{1})(?:-)?([0-2]{1}\d{1}|[3]{1}[0-1]{1})(?:\s)?([0-1]{1}\d{1}|[2]{1}[0-3]{1})(?::)?([0-5]{1}\d{1})(?::)?([0-5]{1}\d{1})<br>匹配：       00-00-00 00:00:00 | 0000-00-00 00:00:00 | 09-05-22 08:16:00 | 1970-00-00 00:00:00 | 20090522081600<br>不匹配：   2009-13:01 00:00:00 | 2009-12-32 00:00:00 | 2002-12-31 24:00:00 | 2002-12-31 23:60:00 | 02-12-31 23:00:60</p>
<p>正则表达式： ^[0-9]{4}-(((0[13578]|(10|12))-(0[1-9]|[1-2][0-9]|3[0-1]))|(02-(0[1-9]|[1-2][0-9]))|((0[469]|11)-(0[1-9]|[1-2][0-9]|30)))$<br>匹配：       2004-04-30 | 2004-02-29<br>不匹配：     2004-04-31 | 2004-02-30</p>
<p>正则表达式： ^([1-9]|1[0-2]|0[1-9]){1}(:[0-5][0-9][aApP][mM]){1}$<br>匹配：       08:00AM | 10:00am | 7:00pm<br>不匹配：     13:00pm | 12:65am</p>
<p>正则表达式： ^(([1-9])|(0[1-9])|(1[0-2]))\/(([0-9])|([0-2][0-9])|(3[0-1]))\/(([0-9][0-9])|([1-2][0,9][0-9][0-9]))$<br>匹配：       01/01/2001 | 1/1/1999 | 10/20/2080<br>不匹配：     13/01/2001 | 1/1/1800 | 10/32/2080</p>
<h3 id="匹配电话号码"><a href="#匹配电话号码" class="headerlink" title="匹配电话号码"></a>匹配电话号码</h3><p>正则表达式： \d{3}-\d{8}|\d{4}-\d{7}<br>匹配：       0511-4405222 | 021-87888822<br>不匹配：     02-552255 12345-784787</p>
<p>正则表达式： (^([0]\d{2}|\d{4}))(\d{6,7}$)<br>匹配：       (021)1234567 | (0411)123456 | (000)000000<br>不匹配：     (123)1234567 | 025123456 | 0252345678</p>
<p>正则表达式： ^(?<national>+?(?:86)?)(?<separator>\s?-?)(?<phone>(?<vender>(13|15|18)[0-9])(?<area>\d{4})(?<id>\d{4}))$<br>匹配：       +8613012345678 | 86 13012345678 | 13245679087<br>不匹配：     +86130123456781231434352 | 13560012513 | ++8613012345678</id></vender></phone></separator></national></p>
<h3 id="匹配字母"><a href="#匹配字母" class="headerlink" title="匹配字母"></a>匹配字母</h3><p>匹配特定字符串：<br>只能输入长度为3的字符：”^.{3}$”。<br>只能输入由26个英文字母组成的字符串：”^[A-Za-z]+$”。<br>只能输入由26个大写英文字母组成的字符串：”^[A-Z]+$”。<br>只能输入由26个小写英文字母组成的字符串：”^[a-z]+$”。<br>只能输入由数字和26个英文字母组成的字符串：”^[A-Za-z0-9]+$”。<br>只能输入由数字、26个英文字母或者下划线组成的字符串：”^\w+$”。</p>
<h3 id="常用正则表达式大全"><a href="#常用正则表达式大全" class="headerlink" title="常用正则表达式大全"></a>常用正则表达式大全</h3><p>部分匹配规则预览：<br>中国电话号码验证<br>匹配形式如:0511-4405222 或者021-87888822 或者 021-44055520-555 或者 (0511)4405222<br>正则表达式 “((d{3,4})|d{3,4}-)?d{7,8}(-d{3})*”</p>
<p>中国邮政编码验证<br>匹配形式如:215421<br>正则表达式 “d{6}”</p>
<p>电子邮件验证<br>匹配形式如:justali@justdn.com<br>正则表达式 “w+([-+.]w+)<em>@w+([-.]w+)</em>.w+([-.]w+)*”</p>
<p>身份证验证<br>匹配形式如:15位或者18位身份证<br>正则表达式 “d{18}|d{15}”</p>
<p>常用数字验证<br>正则表达式<br>“d{n}” n为规定长度<br>“d{n,m}” n到m的长度范围</p>
<p>非法字符验证<br>匹配非法字符如:&lt; &gt; &amp; / ‘ |<br>正则表达式 [^&lt;&gt;&amp;/|’]+</p>
<p>日期验证<br>匹配形式如:20030718,030718<br>范围:1900–2099<br>正则表达式((((19){1}|(20){1})d{2})|d{2})[01]{1}d{1}[0-3]{1}d{1}<br>正则表达式是一个好东西，但是一般情况下，我们需要验证的内容少之又少。</p>
<h3 id="FOR-JAVA"><a href="#FOR-JAVA" class="headerlink" title="FOR JAVA"></a>FOR JAVA</h3><p>正则表达式并不仅限于某一种语言，但是在每种语言中有细微的差别。我是一名Javar！</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;正则表达式介绍&quot;&gt;&lt;a href=&quot;#正则表达式介绍&quot; class=&quot;headerlink&quot; title=&quot;正则表达式介绍&quot;&gt;&lt;/a&gt;正则表达式介绍&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;在编写处理字符串的程序或网页时，经常会有查找符合某些复杂规则的字符串的需要。正则表达式就是用于描述这些规则的工具。换句话说，正则表达式就是记录文本规则的代码。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="正则表达式" scheme="http://blog.zeyu0633.com/categories/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
    
    
      <category term="Javar必知必会" scheme="http://blog.zeyu0633.com/tags/Javar%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/"/>
    
  </entry>
  
  <entry>
    <title>正则表达式 知识点</title>
    <link href="http://blog.zeyu0633.com/2017/03/12/ze-topics/"/>
    <id>http://blog.zeyu0633.com/2017/03/12/ze-topics/</id>
    <published>2017-03-12T04:00:00.000Z</published>
    <updated>2017-03-30T15:09:36.085Z</updated>
    
    <content type="html"><![CDATA[<h3 id="正则表达式介绍"><a href="#正则表达式介绍" class="headerlink" title="正则表达式介绍"></a>正则表达式介绍</h3><blockquote>
<p>在编写处理字符串的程序或网页时，经常会有查找符合某些复杂规则的字符串的需要。正则表达式就是用于描述这些规则的工具。换句话说，正则表达式就是记录文本规则的代码。</p>
</blockquote>
<a id="more"></a>
<h2 id="常用知识点详解"><a href="#常用知识点详解" class="headerlink" title="常用知识点详解"></a>常用知识点详解</h2><h3 id="元字符详解"><a href="#元字符详解" class="headerlink" title="元字符详解"></a>元字符详解</h3><h4 id="先来看几个栗子"><a href="#先来看几个栗子" class="headerlink" title="先来看几个栗子"></a>先来看几个栗子</h4><blockquote>
<ul>
<li><font color="#B22222">\ba\w<em>\b</em></font>匹配以字母a开头的单词——先是某个单词开始处(\b)，然后是字母a,然后是任意数量的字母或数字(\w)，最后是单词结束处(\b)。</li>
<li><font color="#B22222">\d+</font>匹配1个或更多连续的数字。这里的+是和<em>类似的元字符，不同的是</em>匹配重复任意次(可能是0次)，而+则匹配重复1次或更多次。</li>
<li><font color="#B22222">\b\w{6}\b</font>匹配刚好6个字母/数字的单词。</li>
<li><font color="#B22222">\bhi\b.*\bLucy\b</font>匹配先是一个单词hi,然后是任意个任意字符(但不能是换行)，最后是Lucy这个单词。</li>
</ul>
</blockquote>
<h4 id="常用的元字符"><a href="#常用的元字符" class="headerlink" title="常用的元字符"></a>常用的元字符</h4><table>
<thead>
<tr>
<th>代码</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><font color="#0099ff">.</font><br></td>
<td style="text-align:center">匹配除换行符以外的任意字符</td>
</tr>
<tr>
<td><font color="#0099ff">\w</font><br></td>
<td style="text-align:center">匹配字母或数字或下划线或汉字</td>
</tr>
<tr>
<td><font color="#0099ff">\s</font><br></td>
<td style="text-align:center">匹配任意的空白符</td>
</tr>
<tr>
<td><font color="#0099ff">\d</font><br></td>
<td style="text-align:center">匹配数字</td>
</tr>
<tr>
<td><font color="#0099ff">\b</font><br></td>
<td style="text-align:center">匹配单词的开始或结束</td>
</tr>
<tr>
<td><font color="#0099ff">^</font><br></td>
<td style="text-align:center">匹配字符串的开始</td>
</tr>
<tr>
<td><font color="#0099ff">$</font><br></td>
<td style="text-align:center">匹配字符串的结束</td>
</tr>
</tbody>
</table>
<h4 id="和"><a href="#和" class="headerlink" title="^和$"></a>^和$</h4><blockquote>
<p>元字符^（和数字6在同一个键位上的符号）和$都匹配一个位置，这和\b有点类似。^匹配你要用来查找的字符串的开头，$匹配结尾。这两个代码在验证输入的内容时非常有用，比如一个网站如果要求你填写的QQ号必须为5位到12位数字时，可以使用：^\d{5,12}$。<br> 这里的{5,12}和前面介绍过的{2}是类似的，只不过{2}匹配只能不多不少重复2次，{5,12}则是重复的次数不能少于5次，不能多于12次，否则都不匹配。<br> 因为使用了^和$，所以输入的整个字符串都要用来和\d{5,12}来匹配，也就是说整个输入必须是5到12个数字，因此如果输入的QQ号能匹配这个正则表达式的话，那就符合要求了。</p>
</blockquote>
<h3 id="转义字符详解"><a href="#转义字符详解" class="headerlink" title="转义字符详解"></a>转义字符详解</h3><blockquote>
<p>尴尬，怎么查元字符本身呢？？<br>这时你就得使用<font color="#B22222"> \ </font><br>来取消这些字符的特殊意义。<br>你应该使用.和*。当然，要查找\本身，你也得用\。</p>
<ul>
<li><font color="#B22222">unibetter.com</font>匹配unibetter.com。</li>
<li><font color="#B22222">C:\Windows</font>匹配C:\Windows。</li>
</ul>
</blockquote>
<h3 id="重复匹配详解"><a href="#重复匹配详解" class="headerlink" title="重复匹配详解"></a>重复匹配详解</h3><blockquote>
<p>*,+,{2},{5,12}这几个匹配重复的方式上面已经有了</p>
</blockquote>
<h4 id="常用的限定符"><a href="#常用的限定符" class="headerlink" title="常用的限定符"></a>常用的限定符</h4><table>
<thead>
<tr>
<th>代码</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><font color="#0099ff">*</font><br></td>
<td style="text-align:center">重复零次或更多次</td>
</tr>
<tr>
<td><font color="#0099ff">+</font><br></td>
<td style="text-align:center">重复一次或更多次</td>
</tr>
<tr>
<td><font color="#0099ff">?</font><br></td>
<td style="text-align:center">重复零次或一次</td>
</tr>
<tr>
<td><font color="#0099ff">{n}</font><br></td>
<td style="text-align:center">重复n次</td>
</tr>
<tr>
<td><font color="#0099ff">{n,}</font><br></td>
<td style="text-align:center">重复n次或更多次</td>
</tr>
<tr>
<td><font color="#0099ff">{n,m}</font><br></td>
<td style="text-align:center">重复n到m次</td>
</tr>
</tbody>
</table>
<h4 id="栗子"><a href="#栗子" class="headerlink" title="栗子"></a>栗子</h4><blockquote>
<ul>
<li><font color="#B22222">Windows\d+</font>匹配Windows后面跟1个或更多数字。</li>
<li><font color="#B22222">^\w+</font>匹配一行的第一个单词(或整个字符串的第一个单词，具体匹配哪个意思得看选项设置)。</li>
</ul>
</blockquote>
<h3 id="字符类详解"><a href="#字符类详解" class="headerlink" title="字符类详解"></a>字符类详解</h3><blockquote>
<p>“(”和“)”也是元字符，后面的分组节里会提到，所以在这里需要使用转义。<br>要想查找数字，字母或数字，空白是很简单的，因为已经有了对应这些字符集合的元字符，但是如果你想匹配没有预定义元字符的字符集合(比如元音字母a,e,i,o,u),应该怎么办？</p>
</blockquote>
<h4 id="栗子-1"><a href="#栗子-1" class="headerlink" title="栗子"></a>栗子</h4><blockquote>
<ul>
<li><font color="#B22222">[aeiou]</font>匹配任何一个英文元音字母。</li>
<li><font color="#B22222">[.?!]</font>匹配标点符号(.或?或!)。</li>
<li><font color="#B22222">[0-9]</font>代表的含意与\d就是完全一致的：一位数字。</li>
<li><font color="#B22222">[a-z0-9A-Z_]</font>等同于\w（如果只考虑英文的话）。</li>
<li><font color="#B22222">(?0\d{2}[) -]?\d{8}</font>这个表达式可以匹配几种格式的电话号码，像(010)88886666，或022-22334455，或02912345678等。我们对它进行一些分析吧：首先是一个转义字符(,它能出现0次或1次(?),然后是一个0，后面跟着2个数字(\d{2})，然后是)或-或空格中的一个，它出现1次或不出现(?)，最后是8个数字(\d{8})。。</li>
</ul>
</blockquote>
<h3 id="分枝条件详解"><a href="#分枝条件详解" class="headerlink" title="分枝条件详解"></a>分枝条件详解</h3><blockquote>
<p>不幸的是，刚才那个表达式也能匹配010)12345678或(022-87654321这样的“不正确”的格式。要解决这个问题，我们需要用到分枝条件。正则表达式里的分枝条件指的是有几种规则，如果满足其中任意一种规则都应该当成匹配，具体方法是用|把不同的规则分隔开。听不明白？没关系，看例子：</p>
</blockquote>
<h4 id="栗子-2"><a href="#栗子-2" class="headerlink" title="栗子"></a>栗子</h4><blockquote>
<ul>
<li><font color="#B22222">0\d{2}-\d{8}|0\d{3}-\d{7}</font>这个表达式能匹配两种以连字号分隔的电话号码：一种是三位区号，8位本地号(如010-12345678)，一种是4位区号，7位本地号(0376-2233445)。</li>
<li><font color="#B22222">(0\d{2})[- ]?\d{8}|0\d{2}[- ]?\d{8}</font>这个表达式匹配3位区号的电话号码，其中区号可以用小括号括起来，也可以不用，区号与本地号间可以用连字号或空格间隔，也可以没有间隔。</li>
<li><font color="#B22222">\d{5}-\d{4}|\d{5}</font>这个表达式用于匹配美国的邮政编码。美国邮编的规则是5位数字，或者用连字号间隔的9位数字。之所以要给出这个例子是因为它能说明一个问题：使用分枝条件时，要注意各个条件的顺序。如果你把它改成\d{5}|\d{5}-\d{4}的话，那么就只会匹配5位的邮编(以及9位邮编的前5位)。原因是匹配分枝条件时，将会从左到右地测试每个条件，如果满足了某个分枝的话，就不会去再管其它的条件了。</li>
</ul>
</blockquote>
<h3 id="分组详解"><a href="#分组详解" class="headerlink" title="分组详解"></a>分组详解</h3><blockquote>
<p>我们已经提到了怎么重复单个字符（直接在字符后面加上限定符就行了）；但如果想要重复多个字符又该怎么办？你可以用小括号来指定子表达式(也叫做分组)，然后你就可以指定这个子表达式的重复次数了</p>
</blockquote>
<h4 id="栗子-3"><a href="#栗子-3" class="headerlink" title="栗子"></a>栗子</h4><blockquote>
<ul>
<li><font color="#B22222">(\d{1,3}.){3}\d{1,3}</font>是一个简单的IP地址匹配表达式。要理解这个表达式，请按下列顺序分析它：\d{1,3}匹配1到3位的数字，(\d{1,3}.){3}匹配三位数字加上一个英文句号(这个整体也就是这个分组)重复3次，最后再加上一个一到三位的数字(\d{1,3})。<br>不幸的是，它也将匹配256.300.888.999这种不可能存在的IP地址。如果能使用算术比较的话，或许能简单地解决这个问题，但是正则表达式中并不提供关于数学的任何功能。</li>
<li><font color="#B22222">((2[0-4]\d|25[0-5]|[01]?\d\d?).){3}(2[0-4]\d|25[0-5]|[01]?\d\d?)</font>使用冗长的分组，选择，字符类来描述一个正确的IP地址。</li>
</ul>
</blockquote>
<h3 id="反义详解"><a href="#反义详解" class="headerlink" title="反义详解"></a>反义详解</h3><blockquote>
<p>有时需要查找不属于某个能简单定义的字符类的字符。比如想查找除了数字以外，其它任意字符都行的情况，这时需要用到反义</p>
</blockquote>
<h4 id="常用的翻反义代码"><a href="#常用的翻反义代码" class="headerlink" title="常用的翻反义代码"></a>常用的翻反义代码</h4><table>
<thead>
<tr>
<th>代码</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><font color="#0099ff">\W</font><br></td>
<td style="text-align:center">匹配任意不是字母，数字，下划线，汉字的字符</td>
</tr>
<tr>
<td><font color="#0099ff">\S</font><br></td>
<td style="text-align:center">匹配任意不是空白符的字符</td>
</tr>
<tr>
<td><font color="#0099ff">\D</font><br></td>
<td style="text-align:center">匹配任意非数字的字符</td>
</tr>
<tr>
<td><font color="#0099ff">\B</font><br></td>
<td style="text-align:center">匹配不是单词开头或结束的位置</td>
</tr>
<tr>
<td><font color="#0099ff">[^x]</font><br></td>
<td style="text-align:center">匹配除了x以外的任意字符</td>
</tr>
<tr>
<td><font color="#0099ff">[^aeiou]</font><br></td>
<td style="text-align:center">匹配除了aeiou这几个字母以外的任意字符</td>
</tr>
</tbody>
</table>
<h4 id="栗子-4"><a href="#栗子-4" class="headerlink" title="栗子"></a>栗子</h4><blockquote>
<ul>
<li><font color="#B22222">\S+</font>匹配不包含空白符的字符串。</li>
</ul>
</blockquote>
<h3 id="分割线"><a href="#分割线" class="headerlink" title="-分割线-"></a>-分割线-</h3><h3 id="后向引用详解"><a href="#后向引用详解" class="headerlink" title="后向引用详解"></a>后向引用详解</h3><blockquote>
<p>使用小括号指定一个子表达式后，匹配这个子表达式的文本(也就是此分组捕获的内容)可以在表达式或其它程序中作进一步的处理。默认情况下，每个分组会自动拥有一个组号，规则是：<br>从左向右，以分组的左括号为标志，第一个出现的分组的组号为1，第二个为2，以此类推。<br>后向引用用于重复搜索前面某个分组匹配的文本。例如：<br>\1：代表分组1匹配的文本。</p>
</blockquote>
<h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><blockquote>
<ul>
<li><font color="#B22222">\b(\w+)\b\s+\1\b</font>可以用来匹配重复的单词，像go go, 或者kitty kitty。这个表达式首先是一个单词，也就是单词开始处和结束处之间的多于一个的字母或数字(\b(\w+)\b)，这个单词会被捕获到编号为1的分组中，然后是1个或几个空白符(\s+)，最后是分组1中捕获的内容（也就是前面匹配的那个单词）(\1)。</li>
</ul>
</blockquote>
<h4 id="常用分组语法"><a href="#常用分组语法" class="headerlink" title="常用分组语法"></a>常用分组语法</h4><table>
<thead>
<tr>
<th>分类</th>
<th>代码</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>捕获</td>
<td></td>
<td style="text-align:center"><font color="#0099ff">(exp)</font><br></td>
<td>匹配exp,并捕获文本到自动命名的组里</td>
</tr>
<tr>
<td>捕获</td>
<td></td>
<td style="text-align:center"><font color="#0099ff">(?<name>exp)</name></font><br></td>
<td>匹配exp,并捕获文本到名称为name的组里，也可以写成(?’name’exp)</td>
</tr>
<tr>
<td>捕获</td>
<td></td>
<td style="text-align:center"><font color="#0099ff">(?:exp)</font><br></td>
<td>匹配exp,不捕获匹配的文本，也不给此分组分配组号</td>
</tr>
<tr>
<td>零宽断言</td>
<td></td>
<td style="text-align:center"><font color="#0099ff">(?=exp)</font><br></td>
<td>匹配exp前面的位置</td>
</tr>
<tr>
<td>零宽断言</td>
<td></td>
<td style="text-align:center"><font color="#0099ff">(?&lt;=exp)</font><br></td>
<td>匹配exp后面的位置</td>
</tr>
<tr>
<td>零宽断言</td>
<td></td>
<td style="text-align:center"><font color="#0099ff">(?!exp)</font><br></td>
<td>匹配后面跟的不是exp的位置</td>
</tr>
<tr>
<td>零宽断言</td>
<td></td>
<td style="text-align:center"><font color="#0099ff">(?&lt;!exp)</font><br></td>
<td>匹配前面不是exp的位置</td>
</tr>
<tr>
<td>注释</td>
<td></td>
<td style="text-align:center"><font color="#0099ff">    (?#comment)</font><br></td>
<td>这种类型的分组不对正则表达式的处理产生任何影响，用于提供注释让人阅读</td>
</tr>
</tbody>
</table>
<h3 id="零宽断言详解"><a href="#零宽断言详解" class="headerlink" title="零宽断言详解"></a>零宽断言详解</h3><blockquote>
<p>断言用来声明一个应该为真的事实。正则表达式中只有当断言为真时才会继续进行匹配。<br> 接下来的四个用于查找在某些内容(但并不包括这些内容)之前或之后的东西，也就是说它们像\b,^,$那样用于指定一个位置，这个位置应该满足一定的条件(即断言)，因此它们也被称为零宽断言。</p>
</blockquote>
<h4 id="栗子-5"><a href="#栗子-5" class="headerlink" title="栗子"></a>栗子</h4><ul>
<li>(?=exp)也叫零宽度正预测先行断言，它断言自身出现的位置的后面能匹配表达式exp。比如\b\w+(?=ing\b)，匹配以ing结尾的单词的前面部分(除了ing以外的部分)，如查找I’m singing while you’re dancing.时，它会匹配sing和danc。</li>
<li>(?&lt;=exp)也叫零宽度正回顾后发断言，它断言自身出现的位置的前面能匹配表达式exp。比如(?&lt;=\bre)\w+\b会匹配以re开头的单词的后半部分(除了re以外的部分)，例如在查找reading a book时，它匹配ading。</li>
<li>假如你想要给一个很长的数字中每三位间加一个逗号(当然是从右边加起了)，你可以这样查找需要在前面和里面添加逗号的部分：((?&lt;=\d)\d{3})*\b，用它对1234567890进行查找时结果是234567890。</li>
<li>(?&lt;=\s)\d+(?=\s)匹配以空白符间隔的数字(再次强调，不包括这些空白符)。</li>
</ul>
<h3 id="负向零宽断言详解"><a href="#负向零宽断言详解" class="headerlink" title="负向零宽断言详解"></a>负向零宽断言详解</h3><blockquote>
<p>负向零宽断言只匹配一个位置，并不消费任何字符。</p>
</blockquote>
<h4 id="栗子-6"><a href="#栗子-6" class="headerlink" title="栗子"></a>栗子</h4><ul>
<li>零宽度负预测先行断言(?!exp)，断言此位置的后面不能匹配表达式exp。例如：\d{3}(?!\d)匹配三位数字，而且这三位数字的后面不能是数字；\b((?!abc)\w)+\b匹配不包含连续字符串abc的单词。</li>
<li>(?&lt;!exp),零宽度正回顾后发断言来断言此位置的前面不能匹配表达式exp：(?&lt;![a-z])\d{7}匹配前面不是小写字母的七位数字。</li>
<li>(?&lt;=&lt;(\w+)&gt;).<em>(?=&lt;\/\1&gt;)匹配不包含属性的简单HTML标签内里的内容。(&lt;?(\w+)&gt;)指定了这样的前缀：被尖括号括起来的单词(比如可能是<b>)，然后是.</b></em>(任意的字符串),最后是一个后缀(?=&lt;\/\1&gt;)。注意后缀里的\/，它用到了前面提过的字符转义；\1则是一个反向引用，引用的正是捕获的第一组，前面的(\w+)匹配的内容，这样如果前缀实际上是<b>的话，后缀就是</b>了。整个表达式匹配的是<b>和</b>之间的内容(再次提醒，不包括前缀和后缀本身)。</li>
</ul>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><blockquote>
<p>学会了这些就差不多了我觉得，接下来就是理解运用啦</p>
</blockquote>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;正则表达式介绍&quot;&gt;&lt;a href=&quot;#正则表达式介绍&quot; class=&quot;headerlink&quot; title=&quot;正则表达式介绍&quot;&gt;&lt;/a&gt;正则表达式介绍&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;在编写处理字符串的程序或网页时，经常会有查找符合某些复杂规则的字符串的需要。正则表达式就是用于描述这些规则的工具。换句话说，正则表达式就是记录文本规则的代码。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="正则表达式" scheme="http://blog.zeyu0633.com/categories/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
    
    
      <category term="Javar必知必会" scheme="http://blog.zeyu0633.com/tags/Javar%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/"/>
    
  </entry>
  
  <entry>
    <title>正则表达式 概要</title>
    <link href="http://blog.zeyu0633.com/2017/03/12/ze-Summary/"/>
    <id>http://blog.zeyu0633.com/2017/03/12/ze-Summary/</id>
    <published>2017-03-12T02:00:00.000Z</published>
    <updated>2017-03-30T15:09:36.057Z</updated>
    
    <content type="html"><![CDATA[<h3 id="正则表达式介绍"><a href="#正则表达式介绍" class="headerlink" title="正则表达式介绍"></a>正则表达式介绍</h3><blockquote>
<p>在编写处理字符串的程序或网页时，经常会有查找符合某些复杂规则的字符串的需要。正则表达式就是用于描述这些规则的工具。换句话说，正则表达式就是记录文本规则的代码。</p>
</blockquote>
<a id="more"></a>
<h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><ul>
<li>什么是正则表达式<blockquote>
<p>在编写处理字符串的程序或网页时，经常会有查找符合某些复杂规则的字符串的需要。正则表达式就是用于描述这些规则的工具。换句话说，<font color="#0099ff" face="STCAIYUN" size="4">正则表达式就是记录文本规则的代码</font>。</p>
</blockquote>
</li>
<li>正则表达式入门<blockquote>
<p>假设你在一篇英文小说里查找on，你可以使用正则表达式<font color="#B22222">on</font>，下面详解。</p>
</blockquote>
</li>
<li>正则表达式测试<blockquote>
<p>推荐两个在线测试正则表达式的工具:</p>
<ul>
<li><a href="http://tool.oschina.net/regex/" target="_blank" rel="external">正则表达式在线测试</a></li>
<li><a href="http://www.sojson.com/regex/" target="_blank" rel="external">正则表达式在线测试</a></li>
</ul>
</blockquote>
</li>
</ul>
<h2 id="入门小栗子"><a href="#入门小栗子" class="headerlink" title="入门小栗子"></a>入门小栗子</h2><h3 id="要实现在一篇英文小说里查找on"><a href="#要实现在一篇英文小说里查找on" class="headerlink" title="要实现在一篇英文小说里查找on"></a>要实现在一篇英文小说里查找on</h3><blockquote>
<p>Back in 2000, when I thought I was going to be a professional writer, I spent hours a day on LiveJournal doing writing practice with other aspiring poets and authors. Since then I’ve blogged at three different domains about web standards, print design, photography, Flash, illustration, information architecture, ColdFusion, package management, PHP, CSS, advertising, Ruby, Rails, and Erlang.</p>
</blockquote>
<h3 id="写法以及延伸"><a href="#写法以及延伸" class="headerlink" title="写法以及延伸"></a>写法以及延伸</h3><blockquote>
<p>可以使用正则表达式<font color="#B22222">on</font><br>精确匹配这样的字符串：由两个字符组成，前一个字符是o,后一个是n。<br>不幸的是，很多单词里包含on这两个连续的字符，比如professional,information等等。用on来查找的话，这里边的on也会被找出来<br>如果要精确地查找on这个单词的话，我们应该使用<font color="#B22222">\bon\b</font>。<br>\b是正则表达式规定的一个特殊代码（好吧，某些人叫它元字符，metacharacter），代表着单词的开头或结尾，也就是单词的分界处。虽然通常英文的单词是由空格，标点符号或者换行来分隔的，但是\b并不匹配这些单词分隔字符中的任何一个，它只匹配一个位置。<br>那么，像<font color="#B22222">\bhi\b.*\bLucy\b</font>，<font color="#B22222">0\d{2}-\d{8}</font>等又代表什么意思呢？<br>慢慢学~~~</p>
</blockquote>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><ul>
<li>正则表达式定义了字符串的模式。</li>
<li>正则表达式可以用来搜索、编辑或处理文本。</li>
<li>正则表达式并不仅限于某一种语言，但是在每种语言中有细微的差别。</li>
</ul>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;正则表达式介绍&quot;&gt;&lt;a href=&quot;#正则表达式介绍&quot; class=&quot;headerlink&quot; title=&quot;正则表达式介绍&quot;&gt;&lt;/a&gt;正则表达式介绍&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;在编写处理字符串的程序或网页时，经常会有查找符合某些复杂规则的字符串的需要。正则表达式就是用于描述这些规则的工具。换句话说，正则表达式就是记录文本规则的代码。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="正则表达式" scheme="http://blog.zeyu0633.com/categories/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
    
    
      <category term="Javar必知必会" scheme="http://blog.zeyu0633.com/tags/Javar%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/"/>
    
  </entry>
  
  <entry>
    <title>正则表达式 Learning Index</title>
    <link href="http://blog.zeyu0633.com/2017/03/11/zeIndex/"/>
    <id>http://blog.zeyu0633.com/2017/03/11/zeIndex/</id>
    <published>2017-03-11T15:00:00.000Z</published>
    <updated>2017-03-30T15:08:15.864Z</updated>
    
    <content type="html"><![CDATA[<h3 id="正则表达式介绍"><a href="#正则表达式介绍" class="headerlink" title="正则表达式介绍"></a>正则表达式介绍</h3><blockquote>
<p>在编写处理字符串的程序或网页时，经常会有查找符合某些复杂规则的字符串的需要。正则表达式就是用于描述这些规则的工具。换句话说，正则表达式就是记录文本规则的代码。</p>
</blockquote>
<h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h3><ul>
<li><a href="http://blog.zeyu0633.com/2017/03/11/zeIndex/">正则表达式 目录</a></li>
<li><a href="http://blog.zeyu0633.com/2017/03/12/ze-Summary/">正则表达式 概要</a></li>
<li><a href="http://blog.zeyu0633.com/2017/03/12/ze-topics/">正则表达式 知识点</a></li>
<li><a href="http://blog.zeyu0633.com/2017/03/12/ze-practices/">正则表达式 实践</a></li>
<li><a href="http://blog.zeyu0633.com/2017/03/12/ze-java/">正则表达式 java</a></li>
</ul>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;正则表达式介绍&quot;&gt;&lt;a href=&quot;#正则表达式介绍&quot; class=&quot;headerlink&quot; title=&quot;正则表达式介绍&quot;&gt;&lt;/a&gt;正则表达式介绍&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;在编写处理字符串的程序或网页时，经常会有查找符合某些复杂规则的字符串的需要
    
    </summary>
    
      <category term="正则表达式" scheme="http://blog.zeyu0633.com/categories/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
    
    
      <category term="Javar必知必会" scheme="http://blog.zeyu0633.com/tags/Javar%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/"/>
    
  </entry>
  
  <entry>
    <title>Mysql Learning Index</title>
    <link href="http://blog.zeyu0633.com/2017/03/11/mysqlIndex/"/>
    <id>http://blog.zeyu0633.com/2017/03/11/mysqlIndex/</id>
    <published>2017-03-11T15:00:00.000Z</published>
    <updated>2017-03-30T15:16:11.478Z</updated>
    
    <content type="html"><![CDATA[<h3 id="概要"><a href="#概要" class="headerlink" title="概要"></a>概要</h3><blockquote>
<p>最近看了《MySQL 存储过程编程》这本书，再结合在慕课网上的《与MySQL的零距离接触》教程，决定在这里总结一些内容</p>
</blockquote>
<h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h3><ul>
<li><a href="http://blog.zeyu0633.com/2017/03/11/mysqlIndex/">Mysql 目录</a></li>
<li>Mysql 基础</li>
<li><a href="http://blog.zeyu0633.com/2017/03/16/mysql-process/">Mysql 存储过程</a></li>
<li>Mysql 优化</li>
</ul>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;概要&quot;&gt;&lt;a href=&quot;#概要&quot; class=&quot;headerlink&quot; title=&quot;概要&quot;&gt;&lt;/a&gt;概要&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;最近看了《MySQL 存储过程编程》这本书，再结合在慕课网上的《与MySQL的零距离接触》教程，决定在这里总结一些
    
    </summary>
    
      <category term="Mysql" scheme="http://blog.zeyu0633.com/categories/Mysql/"/>
    
    
      <category term="Javar必知必会" scheme="http://blog.zeyu0633.com/tags/Javar%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/"/>
    
  </entry>
  
  <entry>
    <title>SpringBoot 集成Dubbo</title>
    <link href="http://blog.zeyu0633.com/2017/03/06/springBootDubbo/"/>
    <id>http://blog.zeyu0633.com/2017/03/06/springBootDubbo/</id>
    <published>2017-03-06T15:45:00.000Z</published>
    <updated>2017-03-30T05:25:31.617Z</updated>
    
    <content type="html"><![CDATA[<h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><blockquote>
<p>我们常常使用 Springboot 暴露 HTTP 服务，并走 JSON 模式。但慢慢量大了，一种 SOA 的治理方案。这样可以暴露出 Dubbo 服务接口，提供给 Dubbo 消费者进行 RPC 调用。<br>优点</p>
<ul>
<li>Dubbo 不单单只是高性能的 RPC 调用框架，更是 SOA 服务治理的一种方案。</li>
<li>远程通信，向本地调用一样调用远程方法。</li>
<li>集群容错</li>
<li>服务自动发现和注册，可平滑添加或者删除服务提供者。</li>
</ul>
</blockquote>
<a id="more"></a>
<blockquote>
<p>列个提纲</p>
<ul>
<li>分讲dubbo-provider和dubbo-consummer工程</li>
<li>结合dubbo-admin管理平台查看服务</li>
</ul>
</blockquote>
<ul>
<li>zk 3.4.6</li>
<li>dubbo 2.8.4</li>
<li>jdk 1.8.0</li>
</ul>
<h3 id="springboot-dubbo-provider"><a href="#springboot-dubbo-provider" class="headerlink" title="springboot-dubbo-provider"></a>springboot-dubbo-provider</h3><blockquote>
<p>配置文件中配置为服务提供者</p>
</blockquote>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">## Dubbo 服务提供者配置</span></div><div class="line">spring.dubbo.application.name=provider</div><div class="line">spring.dubbo.registry.address=zookeeper:<span class="regexp">//</span><span class="number">127.0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">2181</span></div><div class="line">spring.dubbo.protocol.name=dubbo</div><div class="line">spring.dubbo.protocol.port=<span class="number">20880</span></div><div class="line">spring.dubbo.scan=com.htime.dubbo</div></pre></td></tr></table></figure>
<blockquote>
<p>然后实现一个方法，该方法返回一个实体类City，verison可以区分服务版本，调用时能够区分</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 注册为 Dubbo 服务</span></div><div class="line"><span class="meta">@Service</span>(version = <span class="string">"1.0.0"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CityDubboServiceImpl</span> <span class="keyword">implements</span> <span class="title">CityDubboService</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> City <span class="title">findCityByName</span><span class="params">(String cityName)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> City(<span class="number">1L</span>,<span class="number">2L</span>,<span class="string">"日照"</span>,<span class="string">"是Htime的故乡"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>最重要的是要引入依赖</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- Spring Boot Dubbo 依赖 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.dubbo.springboot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-dubbo<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;dubbo-spring-boot&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="springboot-dubbo-consummer"><a href="#springboot-dubbo-consummer" class="headerlink" title="springboot-dubbo-consummer"></a>springboot-dubbo-consummer</h3><blockquote>
<p>配置文件中配置为消费者，进行服务的订阅</p>
</blockquote>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">## 避免和 server 工程端口冲突</span></div><div class="line">server.port=<span class="number">8081</span></div><div class="line"></div><div class="line"><span class="comment">## Dubbo 服务消费者配置</span></div><div class="line">spring.dubbo.application.name=consumer</div><div class="line">spring.dubbo.registry.address=zookeeper:<span class="regexp">//</span><span class="number">127.0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">2181</span></div><div class="line">spring.dubbo.scan=com.htime.dubbo</div></pre></td></tr></table></figure>
<blockquote>
<p>实现方法的调用，真的就像调用本地方法一样，很棒！！！</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Component</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CityDubboConsumerService</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@Reference</span>(version = <span class="string">"1.0.0"</span>)</div><div class="line">    CityDubboService cityDubboService;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printCity</span><span class="params">()</span> </span>&#123;</div><div class="line">        String cityName=<span class="string">"日照"</span>;</div><div class="line">        City city = cityDubboService.findCityByName(cityName);</div><div class="line">        System.out.println(city.toString());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>在启动类中直接调用printCity()方法，在控制台中打印出以下内容，那么，就成功了，made it！！！<br><img src="http://upload-images.jianshu.io/upload_images/4943424-18b6d38a0f001c99.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="consummer log"></p>
</blockquote>
<h3 id="dubbo-admin管理平台查看服务"><a href="#dubbo-admin管理平台查看服务" class="headerlink" title="dubbo-admin管理平台查看服务"></a>dubbo-admin管理平台查看服务</h3><blockquote>
<p>管理平台能为我们提供很多功能，我是直接以war包的形式起的，war可以把dubbo官方代码clone下来自己编译</p>
<ul>
<li>服务调用情况、健康情况查看</li>
<li>提供软负载，可以对不同服务设置不同权重</li>
<li>······</li>
</ul>
<p>查看服务提供者<br><img src="http://upload-images.jianshu.io/upload_images/4943424-24246882c8a25a1d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="provider view"></p>
<p>查看服务消费者<br><img src="http://upload-images.jianshu.io/upload_images/4943424-93b5cacc8a175068.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="consummer view"></p>
<p>公司用的是dubbo，自己在学spring-cloud，这里展示dubbo，因为，遇到了坑，还有人问问，如果用spring-cloud直接上，出了问题，一脸懵逼<del>~</del></p>
</blockquote>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;概述&quot;&gt;&lt;a href=&quot;#概述&quot; class=&quot;headerlink&quot; title=&quot;概述&quot;&gt;&lt;/a&gt;概述&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;我们常常使用 Springboot 暴露 HTTP 服务，并走 JSON 模式。但慢慢量大了，一种 SOA 的治理方案。这样可以暴露出 Dubbo 服务接口，提供给 Dubbo 消费者进行 RPC 调用。&lt;br&gt;优点&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Dubbo 不单单只是高性能的 RPC 调用框架，更是 SOA 服务治理的一种方案。&lt;/li&gt;
&lt;li&gt;远程通信，向本地调用一样调用远程方法。&lt;/li&gt;
&lt;li&gt;集群容错&lt;/li&gt;
&lt;li&gt;服务自动发现和注册，可平滑添加或者删除服务提供者。&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="SpringBoot" scheme="http://blog.zeyu0633.com/categories/SpringBoot/"/>
    
    
      <category term="Java" scheme="http://blog.zeyu0633.com/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>SpringBoot 身份认证</title>
    <link href="http://blog.zeyu0633.com/2017/03/05/springBootAuth/"/>
    <id>http://blog.zeyu0633.com/2017/03/05/springBootAuth/</id>
    <published>2017-03-05T15:30:00.000Z</published>
    <updated>2017-03-30T05:25:31.550Z</updated>
    
    <content type="html"><![CDATA[<h3 id="要完成的事情"><a href="#要完成的事情" class="headerlink" title="要完成的事情"></a>要完成的事情</h3><blockquote>
<p>只有一点，但是很重要，因为http是无状态的，如果我们设计出来的架构不够安全，那么这一系列的操作都是白搭。</p>
<ul>
<li>身份认证</li>
</ul>
</blockquote>
<a id="more"></a>
<h2 id="分一个割"><a href="#分一个割" class="headerlink" title="分一个割"></a>分一个割</h2><h3 id="身份验证"><a href="#身份验证" class="headerlink" title="身份验证"></a>身份验证</h3><blockquote>
<p>首先根据City相关操作，实现一个关于User的相关操作，从controller一直到sql，就不上代码了，比较简单<br>整体思路就是在用户登录时生成一个token，然后以后的所有请求，header中都携带这个token，服务器对token进行检验<br>通过AccessTokenVerifyInterceptor，来实现拦截，要避开对auth接口的拦截</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Component</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccessTokenVerifyInterceptor</span> <span class="keyword">extends</span> <span class="title">HandlerInterceptorAdapter</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@Autowired</span></div><div class="line">    ValidationService validationService;</div><div class="line"></div><div class="line">    <span class="meta">@Autowired</span></div><div class="line">    UserService userService;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> Logger logger = Logger.getLogger(getClass());</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">        logger.info(<span class="string">"AccessToken executing ..."</span>);</div><div class="line">        <span class="keyword">boolean</span> flag = <span class="keyword">false</span>;</div><div class="line">        String requestUrl = request.getRequestURL().toString();</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> != requestUrl &amp;&amp; requestUrl.contains(<span class="string">"/auth"</span>)) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// token</span></div><div class="line">        String accessToken = request.getHeader(<span class="string">"token"</span>);</div><div class="line">        <span class="keyword">if</span> (StringUtils.isNotBlank(accessToken)) &#123;</div><div class="line">            ValidationModel model = <span class="keyword">new</span> ValidationModel();</div><div class="line"></div><div class="line">            <span class="comment">// 验证token</span></div><div class="line">            Boolean isOk = validationService.verifyAccessToken(accessToken, model);</div><div class="line"></div><div class="line">            <span class="comment">// 用户验证</span></div><div class="line">            <span class="keyword">if</span> (isOk) &#123;</div><div class="line">                User user = userService.getUserById(model.getUid());</div><div class="line">                <span class="keyword">if</span>(user != <span class="keyword">null</span>) &#123;</div><div class="line">                    request.setAttribute(CommonConst.PARAM_USER, user);</div><div class="line">                    logger.info(<span class="string">"AccessToken SUCCESS ...  user:"</span> + user.getUserName() + <span class="string">" - "</span> + accessToken);</div><div class="line">                    flag = <span class="keyword">true</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (!flag) &#123;</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RcException(CommonRes.RES_NEED_AUTH, <span class="string">"auth fail"</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> flag;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>通过ValidationService，完成对token的操作，包括生成与校验</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Service</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ValidationService</span> </span>&#123;</div><div class="line"></div><div class="line">    Gson gson = GsonUtil.createGson();</div><div class="line"></div><div class="line">    <span class="comment">//生成token</span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">createToken</span><span class="params">(User user)</span> </span>&#123;</div><div class="line">        Map&lt;String, String&gt; param = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</div><div class="line">        param.put(<span class="string">"user"</span>, user.getUid().toString());</div><div class="line">        param.put(<span class="string">"time"</span>, <span class="keyword">new</span> Date().getTime() + <span class="string">""</span>);</div><div class="line">        String accessToken = gson.toJson(param);</div><div class="line">        <span class="keyword">return</span> accessToken;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//验证token</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Boolean <span class="title">verifyAccessToken</span><span class="params">(String accessToken, ValidationModel model)</span> </span>&#123;</div><div class="line">        Boolean isOk = <span class="keyword">true</span>;</div><div class="line"></div><div class="line">        Map&lt;String, String&gt; param = gson.fromJson(accessToken, <span class="keyword">new</span> TypeToken&lt;HashMap&lt;String, String&gt;&gt;() &#123;&#125;.getType());</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> == param || <span class="keyword">null</span> == param.get(<span class="string">"user"</span>) || <span class="keyword">null</span> == param.get(<span class="string">"time"</span>))</div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line"></div><div class="line">        <span class="comment">//验证UID</span></div><div class="line">        <span class="keyword">if</span>(!StringUtil.isNumber(param.get(<span class="string">"user"</span>).toString()))</div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        Long uid = Long.parseLong(param.get(<span class="string">"user"</span>));</div><div class="line">        model.setUid(uid);</div><div class="line"></div><div class="line">        <span class="comment">//验证时间</span></div><div class="line">        Date time = <span class="keyword">new</span> Date(Long.parseLong(param.get(<span class="string">"time"</span>)));</div><div class="line">        Integer days = DateUtil.calculateDays(time, <span class="keyword">new</span> Date());</div><div class="line">        <span class="comment">//token的有效期为1天</span></div><div class="line">        <span class="keyword">if</span>(days &gt; <span class="number">1</span>)</div><div class="line">            isOk = <span class="keyword">false</span>;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> isOk;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>通过WebMvcConfig来配置拦截，对所有请求都拦截</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Configuration</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebMvcConfig</span> <span class="keyword">extends</span> <span class="title">WebMvcConfigurerAdapter</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@Bean</span></div><div class="line">    <span class="function"><span class="keyword">public</span> AccessTokenVerifyInterceptor <span class="title">tokenVerifyInterceptor</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> AccessTokenVerifyInterceptor();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> </span>&#123;</div><div class="line">        registry.addInterceptor(tokenVerifyInterceptor()).addPathPatterns(<span class="string">"/*"</span>);</div><div class="line">        <span class="keyword">super</span>.addInterceptors(registry);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>通过UserRestController来进行auth操作，都是明文的~~~</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RestController</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserRestController</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@Autowired</span></div><div class="line">    UserService userService;</div><div class="line"></div><div class="line">    <span class="meta">@Autowired</span></div><div class="line">    ValidationService validationService;</div><div class="line"></div><div class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/auth"</span>, method = RequestMethod.GET)</div><div class="line">    <span class="function"><span class="keyword">public</span> UserRes <span class="title">auth</span><span class="params">(</span></span></div><div class="line">            @RequestParam(  value = <span class="string">"userName"</span>,required = <span class="keyword">true</span> ) String userName ,</div><div class="line">            @<span class="title">RequestParam</span><span class="params">(  value = <span class="string">"userPwd"</span>,required = <span class="keyword">true</span> )</span> String userPwd) &#123;</div><div class="line"></div><div class="line">        UserRes res = <span class="keyword">new</span> UserRes();</div><div class="line">        User user = userService.getUserByAccount(userName, userPwd);</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> == user) &#123;</div><div class="line">             res.setError(CommonRes.RES_NOT_ALLOW, <span class="string">"账号密码错误"</span>);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            res.setUser(user);</div><div class="line">            <span class="comment">//生成token</span></div><div class="line">            String token = validationService.createToken(user);</div><div class="line">            res.setToken(token);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> res;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><blockquote>
<p>首先在不auth的情况下对/hello接口进行访问，我们用postman来进行测试，结果如下，报错啦<br><img src="http://upload-images.jianshu.io/upload_images/4943424-224e533671ec1a90.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="auth fail"></p>
<p>进行auth操作，获取token，我对token的处理很简单粗暴，意思就是这么个意思<br><img src="http://upload-images.jianshu.io/upload_images/4943424-f005157327dafda6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="suth ing"></p>
<p>将token放到header中再对/hello接口进行访问，成功返回，made it！！！<br><img src="http://upload-images.jianshu.io/upload_images/4943424-cb03eb849051fb59.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="auth success"></p>
</blockquote>
<h2 id="分一个割-1"><a href="#分一个割-1" class="headerlink" title="分一个割"></a>分一个割</h2><p>到这里，这个工程就不更新了，接下来与dubbo的集成，将使用新的工程</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;要完成的事情&quot;&gt;&lt;a href=&quot;#要完成的事情&quot; class=&quot;headerlink&quot; title=&quot;要完成的事情&quot;&gt;&lt;/a&gt;要完成的事情&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;只有一点，但是很重要，因为http是无状态的，如果我们设计出来的架构不够安全，那么这一系列的操作都是白搭。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;身份认证&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="SpringBoot" scheme="http://blog.zeyu0633.com/categories/SpringBoot/"/>
    
    
      <category term="Java" scheme="http://blog.zeyu0633.com/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>SpringBoot 日志管理，统一异常处理</title>
    <link href="http://blog.zeyu0633.com/2017/03/05/springBootExceptionAOPLog4j/"/>
    <id>http://blog.zeyu0633.com/2017/03/05/springBootExceptionAOPLog4j/</id>
    <published>2017-03-05T01:30:00.000Z</published>
    <updated>2017-03-30T05:25:31.590Z</updated>
    
    <content type="html"><![CDATA[<h3 id="要完成的事情"><a href="#要完成的事情" class="headerlink" title="要完成的事情"></a>要完成的事情</h3><blockquote>
<p>主要分为以下两点</p>
<ul>
<li>统一异常处理</li>
<li>集成Log4j AOP统一处理web请求</li>
</ul>
</blockquote>
<a id="more"></a>
<h2 id="分一个割"><a href="#分一个割" class="headerlink" title="分一个割"></a>分一个割</h2><h3 id="统一异常处理"><a href="#统一异常处理" class="headerlink" title="统一异常处理"></a>统一异常处理</h3><blockquote>
<p>在服务上提供接口，为了统一状态，我们最好定义一个固定的格式来返回一些状态信息,定义一个CommonRes类</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CommonRes</span>  <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">6094615237599920640L</span>;</div><div class="line">    </div><div class="line">    <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">public</span> <span class="keyword">int</span> RES_OK 					= <span class="number">0</span> ;</div><div class="line">    <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">public</span> <span class="keyword">int</span> RES_UNKNOW_ERROR 		= <span class="number">1000</span> ;</div><div class="line">    <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">public</span> <span class="keyword">int</span> RES_UNSUPPORT 			= <span class="number">1001</span> ;</div><div class="line">    <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">public</span> <span class="keyword">int</span> RES_INVALID_PARAM 		= <span class="number">1002</span> ;</div><div class="line">    <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">public</span> <span class="keyword">int</span> RES_DAOEXCEPTION 		= <span class="number">1003</span> ;</div><div class="line">    <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">public</span> <span class="keyword">int</span> RES_RUNTIME_EXCEPTION 	= <span class="number">1004</span> ;</div><div class="line">    <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">public</span> <span class="keyword">int</span> RES_NO_RIGHT 			= <span class="number">1005</span> ;</div><div class="line">    <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">public</span> <span class="keyword">int</span> RES_NEED_SIGNIN 		= <span class="number">1006</span> ;</div><div class="line">    <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">public</span> <span class="keyword">int</span> RES_AUTH_FAILED 		= <span class="number">1007</span> ;</div><div class="line">    <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">public</span> <span class="keyword">int</span> RES_INVALID_TOKEN 		= <span class="number">1008</span> ;</div><div class="line">    <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">public</span> <span class="keyword">int</span> RES_NEED_AUTH 			= <span class="number">1009</span> ;</div><div class="line">    <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">public</span> <span class="keyword">int</span> RES_TIMEOUT 			= <span class="number">1010</span> ;</div><div class="line">    <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">public</span> <span class="keyword">int</span> RES_NOT_ALLOW 			= <span class="number">1011</span> ;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> Integer rc = RES_OK;</div><div class="line">    <span class="keyword">private</span> String msgInfo;			<span class="comment">//client show info tip</span></div><div class="line">    <span class="keyword">private</span> String errorInfo ; 		<span class="comment">//client show error tip</span></div><div class="line">    <span class="keyword">private</span> String redirect ; 		<span class="comment">//the redirected api server</span></div><div class="line">    <span class="keyword">private</span> String redirectSign ; 	<span class="comment">// the the signture of redirect</span></div><div class="line">    <span class="keyword">private</span> Integer ccdVersion ; 	<span class="comment">// the client configure data version ;</span></div><div class="line">    <span class="keyword">private</span> String requestUrl;      <span class="comment">// request url</span></div><div class="line">    <span class="keyword">private</span> Date serverTime ; 		<span class="comment">//the server current system time</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> CommonRes <span class="title">retOK</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> CommonRes();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> CommonRes <span class="title">retError</span><span class="params">(<span class="keyword">int</span> errorType,String errorInfo)</span> </span>&#123;</div><div class="line">        CommonRes commonRes= <span class="keyword">new</span> CommonRes();</div><div class="line">        commonRes.rc=errorType;</div><div class="line">        commonRes.errorInfo=errorInfo;</div><div class="line">        <span class="keyword">return</span> commonRes;</div><div class="line">    &#125;</div><div class="line">  </div><div class="line">    <span class="comment">//省略get&amp;set方法</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>创建一个自定义异常</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RcException</span> <span class="keyword">extends</span> <span class="title">Exception</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">protected</span> Integer rc;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getRc</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> rc;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRc</span><span class="params">(Integer rc)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.rc = rc;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RcException</span><span class="params">(String message)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(message);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RcException</span><span class="params">(<span class="keyword">int</span> rc,String info)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(info);</div><div class="line">        <span class="keyword">this</span>.setRc(rc);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>为RcException和Exception异常创建对应的处理</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@ControllerAdvice</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GlobalExceptionHandler</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@ExceptionHandler</span>(value = RcException.class)</div><div class="line">    <span class="meta">@ResponseBody</span></div><div class="line">    <span class="function"><span class="keyword">public</span> CommonRes <span class="title">jsonSelfErrorHandler</span><span class="params">(HttpServletRequest req, RcException e)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">        CommonRes res = <span class="keyword">new</span> CommonRes();</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> == e.getRc())</div><div class="line">            res.setRc(CommonRes.RES_RUNTIME_EXCEPTION);</div><div class="line">        <span class="keyword">else</span></div><div class="line">            res.setRc(e.getRc());</div><div class="line">        res.setErrorInfo(e.getMessage());</div><div class="line">        res.setServerTime(<span class="keyword">new</span> Date());</div><div class="line">        res.setRequestUrl(req.getRequestURL().toString());</div><div class="line">        <span class="keyword">return</span> res;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@ExceptionHandler</span>(value = Exception.class)</div><div class="line">    <span class="meta">@ResponseBody</span></div><div class="line">    <span class="function"><span class="keyword">public</span> CommonRes <span class="title">jsonErrorHandler</span><span class="params">(HttpServletRequest req, Exception e)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">        CommonRes res = <span class="keyword">new</span> CommonRes();</div><div class="line">        res.setRc(CommonRes.RES_RUNTIME_EXCEPTION);</div><div class="line">        res.setErrorInfo(e.getMessage());</div><div class="line">        res.setServerTime(<span class="keyword">new</span> Date());</div><div class="line">        res.setRequestUrl(req.getRequestURL().toString());</div><div class="line">        <span class="keyword">return</span> res;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>进行测试</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RestController</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloRestController</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> Logger logger = Logger.getLogger(getClass());</div><div class="line"></div><div class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/hello"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">        logger.info(<span class="string">"HelloRestController hello"</span>);</div><div class="line">        <span class="keyword">return</span> <span class="string">"Hello World!"</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/hello/1"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello1</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">"runtime 异常"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/hello/2"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello2</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RcException(<span class="string">"使用默认的error code"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/hello/3"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello3</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RcException(CommonRes.RES_DAOEXCEPTION, <span class="string">"指定error code"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>我们访问hello1(),hello2(),hello3(),可以看到已经成功捕获了我们定义的异常<br><img src="http://upload-images.jianshu.io/upload_images/4943424-7c5bbde67a1d5356.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="exception"></p>
<h3 id="集成log4j与用AOP统一处理web请求"><a href="#集成log4j与用AOP统一处理web请求" class="headerlink" title="集成log4j与用AOP统一处理web请求"></a>集成log4j与用AOP统一处理web请求</h3><blockquote>
<p>需要引入依赖</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- Spring Boot Web 依赖 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j-over-slf4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- log4j 日志 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- AOP 依赖 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-aop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div></pre></td></tr></table></figure>
<blockquote>
<p>src/main/resources目录下加入log4j.properties配置文件，配置日志级别为INFO，并在控制台和文件中进行输出</p>
</blockquote>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># LOG4J配置</span></div><div class="line">log4j.rootCategory=INFO, stdout, file</div><div class="line"><span class="comment"># 控制台输出</span></div><div class="line">log4j.appender.stdout=org.apache.log4j.ConsoleAppender</div><div class="line">log4j.appender.stdout.layout=org.apache.log4j.PatternLayout</div><div class="line">log4j.appender.stdout.layout.ConversionPattern=%d&#123;yyyy-MM-dd HH:mm:ss,SSS&#125; %5p %c<span class="string">&#123;1&#125;</span>:%L - %m%n</div><div class="line"><span class="comment"># root日志输出</span></div><div class="line">log4j.appender.file=org.apache.log4j.DailyRollingFileAppender</div><div class="line">log4j.appender.file.file=logs/all.log</div><div class="line">log4j.appender.file.DatePattern=<span class="string">'.'</span>yyyy-MM-dd</div><div class="line">log4j.appender.file.layout=org.apache.log4j.PatternLayout</div><div class="line">log4j.appender.file.layout.ConversionPattern=%d&#123;yyyy-MM-dd HH:mm:ss,SSS&#125; %5p %c<span class="string">&#123;1&#125;</span>:%L - %m%n</div></pre></td></tr></table></figure>
<p>以上就完成了对log4j的全部配置，程序中就可以使用啦<br>接下来在用AOP同一处理WEB请求中演示log4j的使用</p>
<blockquote>
<p>在application.properties配置，需要使用CGLIB来实现AOP的时候，需要配置spring.aop.proxy-target-class=true，不然默认使用的是标准Java的实现。</p>
</blockquote>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># AOP</span></div><div class="line"><span class="comment"># Add @EnableAspectJAutoProxy.</span></div><div class="line">spring.aop.auto=true</div><div class="line"><span class="comment"># Whether subclass-based (CGLIB) proxies are to be created (true) as opposed to standard Java interface-based proxies (false).</span></div><div class="line">spring.aop.proxy-target-class=false</div></pre></td></tr></table></figure>
<blockquote>
<p>新建一个类RequestLogAspect来进行切面逻辑的处理</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Aspect</span></div><div class="line"><span class="meta">@Order</span>(<span class="number">5</span>)</div><div class="line"><span class="meta">@Component</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RequestLogAspect</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> Logger logger = Logger.getLogger(getClass());</div><div class="line"></div><div class="line">    ThreadLocal&lt;Long&gt; startTime = <span class="keyword">new</span> ThreadLocal&lt;&gt;();<span class="comment">//记录请求消耗的时间</span></div><div class="line"></div><div class="line">    <span class="meta">@Pointcut</span>(<span class="string">"execution(public * com.htime.controller..*.*(..))"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">requestLog</span><span class="params">()</span></span>&#123;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Before</span>(<span class="string">"requestLog()"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doBefore</span><span class="params">(JoinPoint joinPoint)</span> <span class="keyword">throws</span> Throwable </span>&#123;</div><div class="line">        startTime.set(System.currentTimeMillis());</div><div class="line">        <span class="comment">// 接收到请求，记录请求内容</span></div><div class="line">        ServletRequestAttributes attributes = (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();</div><div class="line">        HttpServletRequest request = attributes.getRequest();</div><div class="line">        <span class="comment">// 记录下请求内容</span></div><div class="line">        logger.info(<span class="string">"URL : "</span> + request.getRequestURL().toString());</div><div class="line">        logger.info(<span class="string">"HTTP_METHOD : "</span> + request.getMethod());</div><div class="line">        logger.info(<span class="string">"IP : "</span> + request.getRemoteAddr());</div><div class="line">        logger.info(<span class="string">"CLASS_METHOD : "</span> + joinPoint.getSignature().getDeclaringTypeName() + <span class="string">"."</span> + joinPoint.getSignature().getName());</div><div class="line">        logger.info(<span class="string">"ARGS : "</span> + Arrays.toString(joinPoint.getArgs()));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@AfterReturning</span>(returning = <span class="string">"ret"</span>, pointcut = <span class="string">"requestLog()"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doAfterReturning</span><span class="params">(Object ret)</span> <span class="keyword">throws</span> Throwable </span>&#123;</div><div class="line">        <span class="comment">// 处理完请求，返回内容</span></div><div class="line">        logger.info(<span class="string">"RESPONSE : "</span> + ret);</div><div class="line">        logger.info(<span class="string">"SPEND TIME : "</span> + (System.currentTimeMillis() - startTime.get()) + <span class="string">" ms"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这时，在对接口进行请求，在console中可以看到打印出如下内容<br><img src="http://upload-images.jianshu.io/upload_images/4943424-7093fc3c5a6b5111.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="swagger main"></p>
<h3 id="目前的工程结构"><a href="#目前的工程结构" class="headerlink" title="目前的工程结构"></a>目前的工程结构</h3><p>清晰很重要<br><img src="http://upload-images.jianshu.io/upload_images/4943424-3685ac162ce9a55b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="structure"></p>
<h2 id="分一个割-1"><a href="#分一个割-1" class="headerlink" title="分一个割"></a>分一个割</h2><p>接下来的内容是登录认证与权限控制</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;要完成的事情&quot;&gt;&lt;a href=&quot;#要完成的事情&quot; class=&quot;headerlink&quot; title=&quot;要完成的事情&quot;&gt;&lt;/a&gt;要完成的事情&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;主要分为以下两点&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;统一异常处理&lt;/li&gt;
&lt;li&gt;集成Log4j AOP统一处理web请求&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="SpringBoot" scheme="http://blog.zeyu0633.com/categories/SpringBoot/"/>
    
    
      <category term="Java" scheme="http://blog.zeyu0633.com/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>SpringBoot Mybatis Restful Swagger2</title>
    <link href="http://blog.zeyu0633.com/2017/03/04/springBootMybatisSwagger/"/>
    <id>http://blog.zeyu0633.com/2017/03/04/springBootMybatisSwagger/</id>
    <published>2017-03-04T11:30:00.000Z</published>
    <updated>2017-03-30T05:25:31.629Z</updated>
    
    <content type="html"><![CDATA[<h3 id="要完成的事情"><a href="#要完成的事情" class="headerlink" title="要完成的事情"></a>要完成的事情</h3><blockquote>
<p>主要分为以下三点</p>
<ul>
<li>Mybatis集成</li>
<li>Restful接口提供</li>
<li>Swagger2集成</li>
</ul>
</blockquote>
<a id="more"></a>
<h2 id="分一个割"><a href="#分一个割" class="headerlink" title="分一个割"></a>分一个割</h2><h3 id="工程结构"><a href="#工程结构" class="headerlink" title="工程结构"></a>工程结构</h3><p>工程结构尽量做到清晰，分层合理<br><img src="http://upload-images.jianshu.io/upload_images/4943424-2f4d1f94c3582730.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="structure"></p>
<h3 id="springboot集成Mybatis"><a href="#springboot集成Mybatis" class="headerlink" title="springboot集成Mybatis"></a>springboot集成Mybatis</h3><p>pom文件中需引入</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- Spring Boot Mybatis 依赖 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mybatis-spring-boot&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- MySQL 连接驱动依赖 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mysql-connector&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div></pre></td></tr></table></figure>
<p>在application.properties中配置<br><figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">## 数据源配置</span></div><div class="line">spring.datasource.url=jdbc:mysql:<span class="regexp">//localhost</span>:<span class="number">3306</span>/springbootdb?useUnicode=true&amp;characterEncoding=utf8</div><div class="line">spring.datasource.username=root</div><div class="line">spring.datasource.password=ning081<span class="number">0</span></div><div class="line">spring.datasource.driver-class-name=com.mysql.jdbc.Driver</div><div class="line"></div><div class="line"><span class="comment">## Mybatis 配置</span></div><div class="line">mybatis.typeAliasesPackage=com.htime.domain</div><div class="line">mybatis.mapperLocations=classpath:mapper/*.xml</div></pre></td></tr></table></figure></p>
<p>application.properties中已经指定了实体类和xml的扫描位置，还有dao层的扫描需要配置，需要在启动类中指定</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@SpringBootApplication</span></div><div class="line"><span class="comment">// mapper 接口类扫描包配置</span></div><div class="line"><span class="meta">@MapperScan</span>(<span class="string">"com.htime.dao"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringbootLearningApplication</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        <span class="comment">// 程序启动入口</span></div><div class="line">        <span class="comment">// 启动嵌入式的 Tomcat 并初始化 Spring 环境及其各 Spring 组件</span></div><div class="line">        SpringApplication.run(SpringbootLearningApplication.class, args);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="springboot提供Restful接口"><a href="#springboot提供Restful接口" class="headerlink" title="springboot提供Restful接口"></a>springboot提供Restful接口</h3><p>集成restful接口就比较简单啦，只需要在加上类注解@RestController，然后不同的api的指定遵循rest方式，代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by HTime on 2017/3/3.</div><div class="line"> */</div><div class="line"><span class="meta">@RestController</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CityResController</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@Autowired</span></div><div class="line">    <span class="keyword">private</span> CityService cityService;</div><div class="line"></div><div class="line">    <span class="meta">@ApiOperation</span>(value=<span class="string">"获取城市详细信息"</span>, notes=<span class="string">"根据城市ID来获取城市详细信息"</span>)</div><div class="line">    <span class="meta">@ApiImplicitParam</span>(name = <span class="string">"id"</span>, value = <span class="string">"城市ID"</span>, required = <span class="keyword">true</span>, dataType = <span class="string">"Long"</span>)</div><div class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/api/city/&#123;id&#125;"</span>, method = RequestMethod.GET)</div><div class="line">    <span class="function"><span class="keyword">public</span> City <span class="title">findOneCity</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Long id) </span>&#123;</div><div class="line">        <span class="keyword">return</span> cityService.findCityById(id);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@ApiOperation</span>(value=<span class="string">"获取所有城市"</span>, notes=<span class="string">"获取所有城市信息"</span>)</div><div class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/api/city"</span>, method = RequestMethod.GET)</div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;City&gt; <span class="title">findAllCity</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> cityService.findAllCity();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@ApiOperation</span>(value=<span class="string">"创建城市"</span>, notes=<span class="string">"根据City实体创建城市"</span>)</div><div class="line">    <span class="meta">@ApiImplicitParam</span>(name = <span class="string">"city"</span>, value = <span class="string">"城市详细实体city"</span>, required = <span class="keyword">true</span>, dataType = <span class="string">"City"</span>)</div><div class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/api/city"</span>, method = RequestMethod.POST)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createCity</span><span class="params">(@RequestBody City city)</span> </span>&#123;</div><div class="line">        cityService.saveCity(city);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@ApiOperation</span>(value=<span class="string">"更新城市"</span>, notes=<span class="string">"根据传过来的City实体对是实体中的City ID进行更新"</span>)</div><div class="line">    <span class="meta">@ApiImplicitParams</span>(&#123;</div><div class="line">            <span class="meta">@ApiImplicitParam</span>(name = <span class="string">"id"</span>, value = <span class="string">"城市ID"</span>, required = <span class="keyword">true</span>, dataType = <span class="string">"Long"</span>),</div><div class="line">            <span class="meta">@ApiImplicitParam</span>(name = <span class="string">"city"</span>, value = <span class="string">"城市详细实体city"</span>, required = <span class="keyword">true</span>, dataType = <span class="string">"City"</span>)</div><div class="line">    &#125;)</div><div class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/api/city/&#123;id&#125;"</span>, method = RequestMethod.PUT)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">modifyCity</span><span class="params">(@PathVariable Long id, @RequestBody City city)</span> </span>&#123;</div><div class="line">        City c = cityService.findCityById(id);</div><div class="line">        c.setCityName(city.getCityName());</div><div class="line">        c.setDescription(city.getDescription());</div><div class="line">        c.setProvinceId(city.getProvinceId());</div><div class="line">        cityService.updateCity(c);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@ApiOperation</span>(value=<span class="string">"删除城市"</span>, notes=<span class="string">"根据指定的城市ID来删除城市"</span>)</div><div class="line">    <span class="meta">@ApiImplicitParam</span>(name = <span class="string">"id"</span>, value = <span class="string">"城市ID"</span>, required = <span class="keyword">true</span>, dataType = <span class="string">"Long"</span>)</div><div class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/api/city/&#123;id&#125;"</span>, method = RequestMethod.DELETE)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteCity</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Long id) </span>&#123;</div><div class="line">        cityService.deleteCity(id);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="springboot集成Swagger2"><a href="#springboot集成Swagger2" class="headerlink" title="springboot集成Swagger2"></a>springboot集成Swagger2</h3><p>目前大多数开发都是前后端完全分离，这样的工作模式需要有很好的开发文档的支撑，swagger2就为我们提供啦这个功能<br>先看看swagger为我们提供了一个怎样的文档形式<br><img src="http://upload-images.jianshu.io/upload_images/4943424-97579134276c2413.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="swagger main"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/4943424-c58f8f779d9e92e6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="swagger detail"></p>
<p>首先我们需要引入依赖<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- Swagger2 RESTful API文档 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>定义一个和Application同级的类Swagger2</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Configuration</span></div><div class="line"><span class="meta">@EnableSwagger</span>2</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Swagger2</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@Bean</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Docket <span class="title">createRestApi</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Docket(DocumentationType.SWAGGER_2)</div><div class="line">                .apiInfo(apiInfo())</div><div class="line">                .select()</div><div class="line">                .apis(RequestHandlerSelectors.basePackage(<span class="string">"com.htime.controller"</span>))</div><div class="line">                .paths(PathSelectors.any())</div><div class="line">                .build();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> ApiInfo <span class="title">apiInfo</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ApiInfoBuilder()</div><div class="line">                .title(<span class="string">"Htime API 文档"</span>)</div><div class="line">                .description(<span class="string">"更多内容请关注：http://blog.zeyu0633.com/"</span>)</div><div class="line">                .termsOfServiceUrl(<span class="string">"http://blog.zeyu0633.com/"</span>)</div><div class="line">                .contact(<span class="string">"Htime"</span>)</div><div class="line">                .version(<span class="string">"1.0"</span>)</div><div class="line">                .build();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>然后就是在你的接口函数上用注解的形式对你的接口进项相关描述，具体可以在以上restful那一块的代码中查看</p>
<h2 id="分一个割-1"><a href="#分一个割-1" class="headerlink" title="分一个割"></a>分一个割</h2><p>接下来的内容是日志管理和统一异常管理~~~</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;要完成的事情&quot;&gt;&lt;a href=&quot;#要完成的事情&quot; class=&quot;headerlink&quot; title=&quot;要完成的事情&quot;&gt;&lt;/a&gt;要完成的事情&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;主要分为以下三点&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Mybatis集成&lt;/li&gt;
&lt;li&gt;Restful接口提供&lt;/li&gt;
&lt;li&gt;Swagger2集成&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="SpringBoot" scheme="http://blog.zeyu0633.com/categories/SpringBoot/"/>
    
    
      <category term="Java" scheme="http://blog.zeyu0633.com/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>SpringBoot HelloWorld</title>
    <link href="http://blog.zeyu0633.com/2017/02/26/springBootStart/"/>
    <id>http://blog.zeyu0633.com/2017/02/26/springBootStart/</id>
    <published>2017-02-26T11:30:00.000Z</published>
    <updated>2017-03-30T05:25:31.603Z</updated>
    
    <content type="html"><![CDATA[<h2 id="开发环境"><a href="#开发环境" class="headerlink" title="开发环境"></a>开发环境</h2><blockquote>
<p>版本这东西，说不清道不明</p>
<ul>
<li>开发工具：IntelliJ IDEA 2016.3.4</li>
<li>Java version：1.8.8_101</li>
<li>maven version： 3.3.3</li>
</ul>
</blockquote>
<a id="more"></a>
<h2 id="开始创世纪"><a href="#开始创世纪" class="headerlink" title="开始创世纪"></a>开始创世纪</h2><h3 id="新建工程"><a href="#新建工程" class="headerlink" title="新建工程"></a>新建工程</h3><p>直接使用idea方式新建工程<br><img src="http://upload-images.jianshu.io/upload_images/4943424-69f817e5b7cc0144.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="new"><br>新建完毕，idea中会生成如下工程结构<br><img src="http://upload-images.jianshu.io/upload_images/4943424-d379ea5a6680c516.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="structure"></p>
<h3 id="POM文件"><a href="#POM文件" class="headerlink" title="POM文件"></a>POM文件</h3><p>增加依赖如下<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- WEB --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h3 id="SpringBoot启动"><a href="#SpringBoot启动" class="headerlink" title="SpringBoot启动"></a>SpringBoot启动</h3><p>除了以下这种直接启动，还可以mvn方式和jar方式<br><img src="http://upload-images.jianshu.io/upload_images/4943424-2f301d754ea8b736.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="start"></p>
<h3 id="Controller层代码"><a href="#Controller层代码" class="headerlink" title="Controller层代码"></a>Controller层代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by HTime on 2017/2/26.</div><div class="line"> */</div><div class="line"><span class="meta">@RestController</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/hello"</span>, method = RequestMethod.GET)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sayHello</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"Hello World!"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Junit测试"><a href="#Junit测试" class="headerlink" title="Junit测试"></a>Junit测试</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RunWith</span>(SpringJUnit4ClassRunner.class)</div><div class="line"><span class="meta">@WebAppConfiguration</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringbootApplicationTests</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">//模拟mvc对象类.</span></div><div class="line">    <span class="keyword">private</span> MockMvc mvc;</div><div class="line"></div><div class="line">    <span class="meta">@Before</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">        mvc = MockMvcBuilders.standaloneSetup(<span class="keyword">new</span> HelloController()).build();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Test</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getHello</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">        mvc.perform(MockMvcRequestBuilders.get(<span class="string">"/hello"</span>).accept(MediaType.APPLICATION_JSON))</div><div class="line">                .andExpect(status().isOk())</div><div class="line">                .andExpect(content().string(equalTo(<span class="string">"Hello World!"</span>)));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>运行getHello()可以在Console中打印出 “Hello World!”</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;开发环境&quot;&gt;&lt;a href=&quot;#开发环境&quot; class=&quot;headerlink&quot; title=&quot;开发环境&quot;&gt;&lt;/a&gt;开发环境&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;版本这东西，说不清道不明&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;开发工具：IntelliJ IDEA 2016.3.4&lt;/li&gt;
&lt;li&gt;Java version：1.8.8_101&lt;/li&gt;
&lt;li&gt;maven version： 3.3.3&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="SpringBoot" scheme="http://blog.zeyu0633.com/categories/SpringBoot/"/>
    
    
      <category term="Java" scheme="http://blog.zeyu0633.com/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>SpringBoot Learning Index</title>
    <link href="http://blog.zeyu0633.com/2017/02/26/springBootIndex/"/>
    <id>http://blog.zeyu0633.com/2017/02/26/springBootIndex/</id>
    <published>2017-02-26T10:00:00.000Z</published>
    <updated>2017-03-30T15:18:17.537Z</updated>
    
    <content type="html"><![CDATA[<h3 id="SpringBoot介绍"><a href="#SpringBoot介绍" class="headerlink" title="SpringBoot介绍"></a>SpringBoot介绍</h3><blockquote>
<p>Spring Boot makes it easy to create stand-alone, production-grade Spring based Applications that you can “just run”. We take an opinionated view of the Spring platform and third-party libraries so you can get started with minimum fuss. Most Spring Boot applications need very little Spring configuration.<br>目标是搭建起一个脚手架</p>
</blockquote>
<h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h3><ul>
<li><a href="http://blog.zeyu0633.com/2017/02/26/springBootIndex/">SpringBoot 目录</a></li>
<li><a href="http://blog.zeyu0633.com/2017/02/26/springBootStart/">SpringBoot HelloWorld</a></li>
<li><a href="http://blog.zeyu0633.com/2017/03/04/springBootMybatisSwagger/">SpringBoot Mybatis Restful Swagger2</a></li>
<li><a href="http://blog.zeyu0633.com/2017/03/05/springBootExceptionAOPLog4j/">SpringBoot 日志管理，统一异常处理</a></li>
<li><a href="http://blog.zeyu0633.com/2017/03/05/springBootAuth/">SpringBoot 身份认证</a></li>
<li><a href="http://blog.zeyu0633.com/2017/03/06/springBootDubbo/">SpringBoot 集成dubbo</a></li>
</ul>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;SpringBoot介绍&quot;&gt;&lt;a href=&quot;#SpringBoot介绍&quot; class=&quot;headerlink&quot; title=&quot;SpringBoot介绍&quot;&gt;&lt;/a&gt;SpringBoot介绍&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;Spring Boot makes
    
    </summary>
    
      <category term="SpringBoot" scheme="http://blog.zeyu0633.com/categories/SpringBoot/"/>
    
    
      <category term="Java" scheme="http://blog.zeyu0633.com/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>Markdown 语法</title>
    <link href="http://blog.zeyu0633.com/2017/02/26/markdown/"/>
    <id>http://blog.zeyu0633.com/2017/02/26/markdown/</id>
    <published>2017-02-26T09:58:27.000Z</published>
    <updated>2017-03-30T15:10:53.738Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Markdown-语法试验田"><a href="#Markdown-语法试验田" class="headerlink" title="Markdown 语法试验田"></a>Markdown 语法试验田</h3><blockquote>
<p>试一试各种样式的模样········</p>
</blockquote>
<a id="more"></a>
<h2 id="区块"><a href="#区块" class="headerlink" title="区块"></a>区块</h2><h3 id="标题"><a href="#标题" class="headerlink" title="标题"></a>标题</h3><p>我是一段文字1</p>
<p>我是第二段文字2</p>
<p>我是第三段文字3</p>
<h3 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h3><blockquote>
<p><strong>忙时专注，闲时自省，警惕忙无章法，闲生杂念</strong></p>
<blockquote>
<p>忙时专注，闲时自省，警惕忙无章法，闲生杂念</p>
<ul>
<li>吃饭</li>
<li>睡觉</li>
<li>打豆豆</li>
</ul>
</blockquote>
</blockquote>
<h3 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h3><ul>
<li>列表一</li>
<li>列表二</li>
<li>列表三</li>
</ul>
<h3 id="文字"><a href="#文字" class="headerlink" title="文字"></a>文字</h3><p><font color="#0099ff" face="STCAIYUN" size="4">忙时专注，闲时自省，警惕忙无章法，闲生杂念</font><br></p>
<p><font color="#008B8B" face="微软雅黑" size="2">忙时专注，闲时自省，警惕忙无章法，闲生杂念</font><br></p>
<p><font color="#B22222" face="黑体" size="5">忙时专注，闲时自省，警惕忙无章法，闲生杂念</font><br></p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Service</span>(version = <span class="string">"1.0.0"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CityDubboServiceImpl</span> <span class="keyword">implements</span> <span class="title">CityDubboService</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> City <span class="title">findCityByName</span><span class="params">(String cityName)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> City(<span class="number">1L</span>,<span class="number">2L</span>,<span class="string">"日照"</span>,<span class="string">"是Htime的故乡"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="区段"><a href="#区段" class="headerlink" title="区段"></a>区段</h2><h3 id="链接"><a href="#链接" class="headerlink" title="链接"></a>链接</h3><p><a href="http://blog.zeyu0633.com/">Htime</a></p>
<h3 id="插入图片"><a href="#插入图片" class="headerlink" title="插入图片"></a>插入图片</h3><p><img src="http://upload-images.jianshu.io/upload_images/4943424-f3592b168de473a2.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="测试图片用路飞"></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;Markdown-语法试验田&quot;&gt;&lt;a href=&quot;#Markdown-语法试验田&quot; class=&quot;headerlink&quot; title=&quot;Markdown 语法试验田&quot;&gt;&lt;/a&gt;Markdown 语法试验田&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;试一试各种样式的模样········&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="markkdown" scheme="http://blog.zeyu0633.com/categories/markkdown/"/>
    
    
      <category term="技能" scheme="http://blog.zeyu0633.com/tags/%E6%8A%80%E8%83%BD/"/>
    
  </entry>
  
  <entry>
    <title>鸡汤</title>
    <link href="http://blog.zeyu0633.com/2017/02/24/new/"/>
    <id>http://blog.zeyu0633.com/2017/02/24/new/</id>
    <published>2017-02-24T09:58:27.000Z</published>
    <updated>2017-03-05T06:22:04.483Z</updated>
    
    <content type="html"><![CDATA[<p>忙时专注，闲时自省，警惕忙无章法，闲生杂念</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;忙时专注，闲时自省，警惕忙无章法，闲生杂念&lt;/p&gt;
    
    </summary>
    
      <category term="鸡汤" scheme="http://blog.zeyu0633.com/categories/%E9%B8%A1%E6%B1%A4/"/>
    
    
      <category term="鸡汤" scheme="http://blog.zeyu0633.com/tags/%E9%B8%A1%E6%B1%A4/"/>
    
  </entry>
  
</feed>
